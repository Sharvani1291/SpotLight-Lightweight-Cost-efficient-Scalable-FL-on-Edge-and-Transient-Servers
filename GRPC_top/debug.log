2025-01-09 19:03:44,926 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-09 19:03:44,926 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-09 19:03:44,927 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-09 19:03:44,928 - INFO - Registered tasks: dict_keys(['celery.chunks', 'celery.chord', 'celery.chord_unlock', 'celery.group', 'celery.map', 'celery.chain', 'celery.backend_cleanup', 'celery.starmap', 'celery.accumulate'])
2025-01-09 19:03:44,928 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-09 19:03:44,928 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-09 19:24:40,195 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-09 19:24:40,210 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-09 19:24:40,211 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-09 19:24:40,212 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-09 19:24:40,213 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-09 19:24:40,214 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-09 19:24:40,215 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-09 19:24:40,216 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-09 19:24:40,217 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-09 19:24:40,218 - INFO - Registered tasks: dict_keys(['celery.group', 'celery.map', 'celery.chain', 'celery.backend_cleanup', 'celery.starmap', 'celery.chord', 'celery.accumulate', 'celery.chunks', 'celery.chord_unlock'])
2025-01-09 19:24:40,219 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:24:40,220 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-09 19:24:40,228 - INFO - Top layer aggregator server started on port 8082.
2025-01-09 19:25:40,277 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-09 19:25:40,278 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-09 19:25:40,278 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-09 19:25:40,278 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-09 19:25:40,278 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-09 19:25:40,278 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-09 19:25:40,279 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-09 19:25:40,279 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-09 19:25:40,279 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-09 19:25:40,279 - INFO - Registered tasks: dict_keys(['celery.chunks', 'celery.chord', 'celery.chord_unlock', 'celery.group', 'celery.map', 'celery.chain', 'celery.backend_cleanup', 'celery.starmap', 'celery.accumulate'])
2025-01-09 19:25:40,279 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:25:40,279 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-09 19:26:55,267 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-09 19:26:55,267 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-09 19:26:55,267 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-09 19:26:55,267 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-09 19:26:55,268 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-09 19:26:57,572 - INFO - Top layer aggregator server started on port 8082.
2025-01-09 19:27:17,700 - INFO - Received aggregated weights from an aggregator.
2025-01-09 19:27:38,227 - INFO - Received aggregated weights from an aggregator.
2025-01-09 19:27:38,354 - INFO - Applied FedAvg and updated the global model.
2025-01-09 19:27:38,357 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:27:38,358 - ERROR - Exception calling application: send_model_to_l2_async() missing 1 required positional argument: 'model_name'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async(args=[updated_model_weights])  # Trigger Celery task to send the updated model
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: send_model_to_l2_async() missing 1 required positional argument: 'model_name'
2025-01-09 19:31:47,976 - INFO - Top layer aggregator server started on port 8082.
2025-01-09 19:31:58,596 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-09 19:31:58,596 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-09 19:31:58,596 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-09 19:31:58,596 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:31:58,597 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-09 19:32:17,980 - INFO - Received aggregated weights from an aggregator.
2025-01-09 19:32:18,000 - INFO - Applied FedAvg and updated the global model.
2025-01-09 19:32:18,003 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:32:18,004 - ERROR - Exception calling application: name 'updated_model_weights_l2' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights_l2, "SimpleCNN"))# Trigger Celery task to send the updated model
NameError: name 'updated_model_weights_l2' is not defined
2025-01-09 19:33:20,595 - INFO - Top layer aggregator server started on port 8082.
2025-01-09 19:33:41,614 - INFO - Received aggregated weights from an aggregator.
2025-01-09 19:33:41,703 - INFO - Applied FedAvg and updated the global model.
2025-01-09 19:33:41,706 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:33:41,750 - ERROR - Exception calling application: Object of type float32 is not JSON serializable
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type float32 is not JSON serializable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights, "SimpleCNN"))# Trigger Celery task to send the updated model
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 594, in apply_async
    return app.send_task(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 799, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/amqp.py", line 518, in send_task_message
    ret = producer.publish(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 175, in publish
    body, content_type, content_encoding = self._prepare(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 268, in _prepare
    body) = dumps(body, serializer=serializer)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 219, in dumps
    with _reraise_errors(EncodeError):
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 45, in _reraise_errors
    reraise(wrapper, wrapper(exc), sys.exc_info()[2])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/exceptions.py", line 34, in reraise
    raise value.with_traceback(tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
kombu.exceptions.EncodeError: Object of type float32 is not JSON serializable
2025-01-09 19:48:09,053 - INFO - Top layer aggregator server started on port 8082.
2025-01-09 19:48:26,726 - INFO - Received aggregated weights from an aggregator.
2025-01-09 19:48:26,807 - INFO - Applied FedAvg and updated the global model.
2025-01-09 19:48:26,810 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-09 19:48:26,812 - ERROR - Exception calling application: name 'updated_model_weights_l2' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights_l2, "SimpleCNN"))# Trigger Celery task to send the updated model
NameError: name 'updated_model_weights_l2' is not defined
2025-01-11 20:44:50,553 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 20:45:37,194 - INFO - Received aggregated weights from an aggregator.
2025-01-11 20:45:37,249 - INFO - Applied FedAvg and updated the global model.
2025-01-11 20:45:37,253 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 20:45:37,254 - ERROR - Exception calling application: name 'updated_model_weights_l2' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights_l2, "SimpleCNN"))# Trigger Celery task to send the updated model
NameError: name 'updated_model_weights_l2' is not defined
2025-01-11 20:45:57,806 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-11 20:45:57,806 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-11 20:45:57,807 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-11 20:45:57,808 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-11 20:45:57,808 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 20:45:57,808 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-11 20:54:56,341 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 20:55:17,614 - INFO - Received aggregated weights from an aggregator.
2025-01-11 20:55:17,633 - INFO - Applied FedAvg and updated the global model.
2025-01-11 20:55:17,637 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 20:55:17,674 - ERROR - Exception calling application: Object of type float32 is not JSON serializable
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type float32 is not JSON serializable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights, "SimpleCNN"))  # Corrected variable
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 594, in apply_async
    return app.send_task(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 799, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/amqp.py", line 518, in send_task_message
    ret = producer.publish(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 175, in publish
    body, content_type, content_encoding = self._prepare(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 268, in _prepare
    body) = dumps(body, serializer=serializer)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 219, in dumps
    with _reraise_errors(EncodeError):
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 45, in _reraise_errors
    reraise(wrapper, wrapper(exc), sys.exc_info()[2])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/exceptions.py", line 34, in reraise
    raise value.with_traceback(tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
kombu.exceptions.EncodeError: Object of type float32 is not JSON serializable
2025-01-11 20:56:42,410 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 20:57:12,138 - INFO - Received aggregated weights from an aggregator.
2025-01-11 20:57:12,158 - INFO - Applied FedAvg and updated the global model.
2025-01-11 20:57:12,161 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 20:59:28,517 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-11 20:59:28,518 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-11 20:59:28,518 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-11 20:59:28,518 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-11 20:59:28,518 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-11 20:59:28,518 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-11 20:59:28,519 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-11 20:59:28,519 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-11 20:59:28,519 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-11 20:59:28,519 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 20:59:28,519 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-11 20:59:34,846 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 20:59:54,145 - INFO - Received aggregated weights from an aggregator.
2025-01-11 20:59:54,165 - INFO - Applied FedAvg and updated the global model.
2025-01-11 20:59:54,168 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 21:03:08,049 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 21:03:16,712 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-11 21:03:16,713 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-11 21:03:16,713 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-11 21:03:16,713 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-11 21:03:16,713 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-11 21:03:16,713 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-11 21:03:16,714 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-11 21:03:16,714 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-11 21:03:16,714 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 21:03:16,714 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-11 21:03:16,714 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-11 21:03:35,397 - INFO - Received aggregated weights from an aggregator.
2025-01-11 21:03:35,417 - INFO - Applied FedAvg and updated the global model.
2025-01-11 21:03:35,420 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-11 21:05:37,102 - INFO - Top layer aggregator server started on port 8082.
2025-01-11 21:05:58,189 - INFO - Received aggregated weights from an aggregator.
2025-01-11 21:05:58,209 - INFO - Applied FedAvg and updated the global model.
2025-01-11 21:05:58,212 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:04:51,105 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:05:05,723 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:05:05,723 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:05:05,723 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:05:05,723 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:05:05,724 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:05:47,532 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:05:47,621 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:05:47,624 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:11:54,082 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:11:54,083 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:11:54,083 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:11:54,083 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:11:54,083 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:11:54,083 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:11:54,084 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:11:54,084 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:11:54,084 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:11:54,084 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:11:54,084 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:11:58,907 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:12:40,148 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:12:40,322 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:12:40,438 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:16:37,968 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:16:37,968 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:16:37,968 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:16:37,969 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:16:37,969 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:16:37,969 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:16:37,969 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:16:37,970 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:16:37,970 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 15:16:37,970 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:16:37,970 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:16:38,198 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:17:11,240 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:17:11,336 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:17:11,338 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 15:17:11,339 - ERROR - Exception calling application: send_model_to_l2_async() takes 1 positional argument but 2 were given
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights, "SimpleCNN"))  # Corrected variable
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: send_model_to_l2_async() takes 1 positional argument but 2 were given
2025-01-15 15:21:08,707 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:21:08,708 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:21:08,708 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:21:08,708 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:21:08,709 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:21:08,710 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:21:53,661 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:22:37,714 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:22:37,939 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:22:37,971 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:43:29,615 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:43:29,640 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:43:29,640 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:43:29,640 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:43:29,641 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:43:33,581 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:44:08,338 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:44:08,338 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:44:08,339 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:44:08,339 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:44:08,339 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:44:08,339 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:44:08,340 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:44:08,340 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:44:08,340 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:44:08,340 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:44:08,340 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:44:37,245 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:44:37,391 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:44:37,393 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:44:37,430 - ERROR - Connection to Redis lost: Retry (0/20) now.
2025-01-15 15:44:37,430 - ERROR - Connection to Redis lost: Retry (1/20) in 1.00 second.
2025-01-15 15:44:38,431 - ERROR - Connection to Redis lost: Retry (2/20) in 1.00 second.
2025-01-15 15:44:39,433 - ERROR - Connection to Redis lost: Retry (3/20) in 1.00 second.
2025-01-15 15:44:40,434 - ERROR - Connection to Redis lost: Retry (4/20) in 1.00 second.
2025-01-15 15:44:41,435 - ERROR - Connection to Redis lost: Retry (5/20) in 1.00 second.
2025-01-15 15:44:42,437 - ERROR - Connection to Redis lost: Retry (6/20) in 1.00 second.
2025-01-15 15:44:43,438 - ERROR - Connection to Redis lost: Retry (7/20) in 1.00 second.
2025-01-15 15:44:44,439 - ERROR - Connection to Redis lost: Retry (8/20) in 1.00 second.
2025-01-15 15:44:45,441 - ERROR - Connection to Redis lost: Retry (9/20) in 1.00 second.
2025-01-15 15:44:46,442 - ERROR - Connection to Redis lost: Retry (10/20) in 1.00 second.
2025-01-15 15:44:47,443 - ERROR - Connection to Redis lost: Retry (11/20) in 1.00 second.
2025-01-15 15:44:48,445 - ERROR - Connection to Redis lost: Retry (12/20) in 1.00 second.
2025-01-15 15:44:49,446 - ERROR - Connection to Redis lost: Retry (13/20) in 1.00 second.
2025-01-15 15:44:50,447 - ERROR - Connection to Redis lost: Retry (14/20) in 1.00 second.
2025-01-15 15:44:51,449 - ERROR - Connection to Redis lost: Retry (15/20) in 1.00 second.
2025-01-15 15:44:52,450 - ERROR - Connection to Redis lost: Retry (16/20) in 1.00 second.
2025-01-15 15:44:53,451 - ERROR - Connection to Redis lost: Retry (17/20) in 1.00 second.
2025-01-15 15:44:54,453 - ERROR - Connection to Redis lost: Retry (18/20) in 1.00 second.
2025-01-15 15:44:55,454 - ERROR - Connection to Redis lost: Retry (19/20) in 1.00 second.
2025-01-15 15:44:56,455 - CRITICAL - 
Retry limit exceeded while trying to reconnect to the Celery redis result store backend. The Celery application must be restarted.

2025-01-15 15:44:56,456 - ERROR - Exception calling application: Error 111 connecting to 127.0.0.1:6380. Connection refused.
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 699, in connect
    sock = self.retry.call_with_retry(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 700, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 1002, in _connect
    raise err
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 990, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 127, in reconnect_on_error
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 177, in _consume_from
    self._pubsub.subscribe(key)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/client.py", line 1634, in subscribe
    ret_val = self.execute_command("SUBSCRIBE", *new_channels.keys())
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/client.py", line 1469, in execute_command
    self.connection = self.connection_pool.get_connection(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 1457, in get_connection
    connection.connect()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 705, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 111 connecting to 127.0.0.1:6380. Connection refused.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 699, in connect
    sock = self.retry.call_with_retry(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 700, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 1002, in _connect
    raise err
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 990, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/connection.py", line 472, in _reraise_as_library_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 798, in send_task
    self.backend.on_task_call(P, task_id)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 373, in on_task_call
    self.result_consumer.consume_from(task_id)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 169, in consume_from
    return self.start(task_id)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 147, in start
    self._consume_from(initial_task_id)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 176, in _consume_from
    with self.reconnect_on_error():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 130, in reconnect_on_error
    self._ensure(self._reconnect_pubsub, ())
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 384, in ensure
    return retry_over_time(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/functional.py", line 318, in retry_over_time
    return fun(*args, **kwargs)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/redis.py", line 106, in _reconnect_pubsub
    metas = self.backend.client.mget(self.subscribed_to)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/commands/core.py", line 1987, in mget
    return self.execute_command("MGET", *args, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/client.py", line 1266, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 1457, in get_connection
    connection.connect()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/redis/connection.py", line 705, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 111 connecting to 127.0.0.1:6380. Connection refused.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights, "SimpleCNN"))  # Corrected variable
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 594, in apply_async
    return app.send_task(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 796, in send_task
    with P.connection._reraise_as_library_errors():
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/connection.py", line 476, in _reraise_as_library_errors
    raise ConnectionError(str(exc)) from exc
kombu.exceptions.OperationalError: Error 111 connecting to 127.0.0.1:6380. Connection refused.
2025-01-15 15:49:23,688 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:49:23,705 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:49:23,705 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:49:23,705 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:49:23,706 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:49:23,706 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:49:23,706 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:49:23,706 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:49:23,706 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:49:23,707 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:49:23,707 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:55:07,359 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:55:07,359 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:55:07,359 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:55:07,360 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:55:07,361 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:55:07,361 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:55:17,093 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 15:55:59,638 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:55:59,780 - INFO - Applied FedAvg and updated the global model.
2025-01-15 15:55:59,787 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:59:13,807 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 15:59:13,807 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 15:59:13,807 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 15:59:13,807 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 15:59:13,807 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 15:59:13,808 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 15:59:33,048 - INFO - Received aggregated weights from an aggregator.
2025-01-15 15:59:33,066 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:05:41,969 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:05:41,970 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:05:41,971 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:05:41,971 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:05:41,972 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:05:41,972 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:05:41,972 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:05:41,973 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:05:41,973 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:05:41,973 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:05:41,974 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:06:01,799 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:06:01,821 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:11:25,662 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:11:25,662 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:11:25,662 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:11:25,662 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:11:25,663 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:11:25,664 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:15:22,771 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:15:22,790 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:16:40,652 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:16:40,652 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:16:40,652 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:16:40,653 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:16:40,654 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:16:40,654 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:16:45,541 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 16:17:03,929 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:17:04,012 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:17:04,015 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:28:17,074 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:28:17,074 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:28:17,074 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:28:17,074 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:28:17,075 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:28:39,559 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:28:39,579 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:32:48,790 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:32:48,790 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:32:48,791 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:32:48,791 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:32:48,791 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:32:48,791 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:32:48,791 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:32:48,792 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:32:48,792 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:32:48,792 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:32:48,792 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:33:08,034 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:33:08,117 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:34:41,321 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:34:41,321 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:34:41,322 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:34:41,323 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:34:41,323 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:34:41,323 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:35:58,079 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 16:37:04,861 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:37:04,861 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:37:04,862 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:37:04,863 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:37:04,863 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:37:33,584 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:37:33,603 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:37:33,606 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:39:24,950 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:39:24,950 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:39:24,950 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:39:24,950 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:39:24,951 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:39:24,952 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:39:51,056 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:39:51,075 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:41:49,798 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:41:49,799 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:41:49,799 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:41:49,799 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:41:49,799 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:41:49,799 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:41:49,800 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:41:49,800 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:41:49,800 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:41:49,800 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:41:49,800 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:42:09,791 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:42:09,868 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:51:25,831 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:51:25,831 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:51:25,831 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:51:25,831 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:51:25,831 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:51:25,832 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:52:36,071 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:52:36,071 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:52:36,072 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:52:36,072 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:52:36,073 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:52:36,073 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:52:36,073 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:52:36,073 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:52:36,074 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:52:36,074 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:52:36,074 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:52:41,447 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 16:53:01,589 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:53:01,676 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:53:01,679 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:54:52,745 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 16:55:05,392 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:55:05,392 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:55:05,392 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:55:05,392 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:55:05,392 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:55:05,393 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:55:26,075 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:55:26,098 - INFO - Applied FedAvg and updated the global model.
2025-01-15 16:55:26,101 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:58:11,495 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 16:58:11,495 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 16:58:11,495 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 16:58:11,496 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 16:58:11,496 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 16:58:11,496 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 16:58:11,496 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 16:58:11,497 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 16:58:11,497 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 16:58:11,497 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 16:58:11,497 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 16:59:30,372 - INFO - Received aggregated weights from an aggregator.
2025-01-15 16:59:30,442 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:00:18,055 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 17:00:18,055 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 17:00:18,056 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 17:00:18,056 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 17:00:18,056 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 17:00:18,056 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 17:00:18,057 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 17:00:18,057 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 17:00:18,057 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 17:00:18,057 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 17:00:18,057 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 17:02:59,597 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:03:17,558 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:03:17,578 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:03:17,578 - ERROR - Exception calling application: name 'store_aggregated_weights' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 54, in SendAggregatedWeights
    store_aggregated_weights.apply_async((updated_model_weights, "SimpleCNN"))
NameError: name 'store_aggregated_weights' is not defined
2025-01-15 17:03:34,532 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:03:52,606 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:03:52,695 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:03:52,695 - ERROR - Exception calling application: 'function' object has no attribute 'apply_async'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 54, in SendAggregatedWeights
    store_aggregated_weights.apply_async((updated_model_weights, "SimpleCNN"))
AttributeError: 'function' object has no attribute 'apply_async'
2025-01-15 17:06:15,695 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:06:34,739 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:06:34,759 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:06:34,760 - ERROR - Exception calling application: name 'app_celery' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 55, in SendAggregatedWeights
    task_result = app_celery.send_task('celery_tasks.store_aggregated_weights_task', args=[updated_model_weights, model_name])
NameError: name 'app_celery' is not defined
2025-01-15 17:10:45,038 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:11:03,866 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:11:03,950 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:11:03,950 - ERROR - Exception calling application: local variable 'updated_model_weights' referenced before assignment
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 62, in SendAggregatedWeights
    task_result = app_celery.send_task('celery_tasks.store_aggregated_weights_task', args=[updated_model_weights, model_name])
UnboundLocalError: local variable 'updated_model_weights' referenced before assignment
2025-01-15 17:11:31,723 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:11:49,567 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:11:49,652 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:11:49,710 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 17:11:49,737 - INFO - Model weights sent successfully to simplecnn_l2.
2025-01-15 17:13:40,027 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:13:58,034 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:13:58,053 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:13:58,097 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 17:15:36,519 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:15:55,346 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:15:55,366 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:15:55,415 - ERROR - Exception calling application: 'celery_tasks.store_aggregated_weights_task'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 65, in SendAggregatedWeights
    current_time = task_result.get()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 251, in get
    return self.backend.wait_for_pending(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/asynchronous.py", line 223, in wait_for_pending
    return result.maybe_throw(callback=callback, propagate=propagate)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 365, in maybe_throw
    self.throw(value, self._to_remote_traceback(tb))
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 358, in throw
    self.on_ready.throw(*args, **kwargs)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/vine/promises.py", line 235, in throw
    reraise(type(exc), exc, tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/vine/utils.py", line 27, in reraise
    raise value
celery.exceptions.NotRegistered: 'celery_tasks.store_aggregated_weights_task'
2025-01-15 17:16:25,778 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:16:44,602 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:16:44,679 - INFO - Applied FedAvg and updated the global model.
2025-01-15 17:16:44,806 - INFO - Task result: 678833cc1df3bc065beb3d7d
2025-01-15 17:16:44,806 - ERROR - Exception calling application: name 'current_version' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 67, in SendAggregatedWeights
    logging.info(f"Global model updated. Inserted ID: {current_time}, Version: {current_version}")
NameError: name 'current_version' is not defined
2025-01-15 17:24:58,553 - INFO - Starting gRPC server...
2025-01-15 17:29:59,858 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:30:15,060 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 17:30:15,060 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 17:30:15,060 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 17:30:15,060 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 17:30:15,060 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 17:30:15,061 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 17:30:36,923 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:30:36,942 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 17:30:36,997 - ERROR - Exception calling application: store_aggregated_weights_task() takes 2 positional arguments but 3 were given
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 68, in SendAggregatedWeights
    current_time = task_result.get()
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 251, in get
    return self.backend.wait_for_pending(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/backends/asynchronous.py", line 223, in wait_for_pending
    return result.maybe_throw(callback=callback, propagate=propagate)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 365, in maybe_throw
    self.throw(value, self._to_remote_traceback(tb))
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/result.py", line 358, in throw
    self.on_ready.throw(*args, **kwargs)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/vine/promises.py", line 235, in throw
    reraise(type(exc), exc, tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/vine/utils.py", line 27, in reraise
    raise value
TypeError: store_aggregated_weights_task() takes 2 positional arguments but 3 were given
2025-01-15 17:31:54,410 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:32:13,393 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:32:13,466 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 17:32:13,549 - INFO - Task result: 6788376de00c571f07504af7
2025-01-15 17:32:13,549 - INFO - Global model updated. Inserted ID: 6788376de00c571f07504af7, Version: 1
2025-01-15 17:32:13,549 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 17:32:13,549 - ERROR - Exception calling application: send_model_to_l2_async() takes 2 positional arguments but 3 were given
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 72, in SendAggregatedWeights
    send_model_to_l2_async.apply_async((updated_model_weights, model_name, self.version))
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: send_model_to_l2_async() takes 2 positional arguments but 3 were given
2025-01-15 17:32:41,503 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 17:32:59,143 - INFO - Received aggregated weights from an aggregator.
2025-01-15 17:32:59,162 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 17:32:59,273 - INFO - Task result: 6788379be00c571f07504af9
2025-01-15 17:32:59,274 - INFO - Global model updated. Inserted ID: 6788379be00c571f07504af9, Version: 1
2025-01-15 17:32:59,275 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 19:47:04,521 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 19:47:04,521 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 19:47:04,522 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 19:47:04,522 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 19:47:04,522 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 19:47:04,523 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 19:47:09,790 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 19:47:33,560 - INFO - Received aggregated weights from an aggregator.
2025-01-15 19:47:33,614 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 19:47:33,699 - INFO - Task result: 6788572536f20d9a7b8354ae
2025-01-15 19:47:33,699 - INFO - Global model updated. Inserted ID: 6788572536f20d9a7b8354ae, Version: 1
2025-01-15 19:47:33,699 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 19:48:23,378 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 19:48:23,378 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 19:48:23,378 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 19:48:23,378 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 19:48:23,379 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 19:48:56,411 - INFO - Received aggregated weights from an aggregator.
2025-01-15 19:48:56,498 - INFO - Applied FedAvg and updated the global model. Current version: 2
2025-01-15 19:48:56,580 - INFO - Task result: 678857781618a717916aace6
2025-01-15 19:48:56,580 - INFO - Global model updated. Inserted ID: 678857781618a717916aace6, Version: 2
2025-01-15 19:52:57,629 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 19:52:57,629 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2, model_name):
    return 1

2025-01-15 19:52:57,629 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 19:52:57,629 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 19:52:57,629 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 19:52:57,630 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 19:53:26,147 - INFO - Received aggregated weights from an aggregator.
2025-01-15 19:53:26,194 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-01-15 19:53:26,347 - INFO - Task result: 6788588651cb10b13f943860
2025-01-15 19:53:26,347 - INFO - Global model updated. Inserted ID: 6788588651cb10b13f943860, Version: 3
2025-01-15 20:14:30,198 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 20:14:30,198 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 20:14:30,198 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 20:14:30,198 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 20:14:30,198 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 20:14:30,198 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 20:14:30,199 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 20:14:30,199 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 20:14:30,199 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 20:14:30,199 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 20:14:30,199 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 20:14:33,561 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 20:14:54,861 - ERROR - Exception calling application: version
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 96, in SendAggregatedWeights
    logging.info(f"Received aggregated weights with version: {request.version}")
AttributeError: version
2025-01-15 20:18:05,780 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 20:18:24,382 - INFO - Received aggregated weights with version: 0
2025-01-15 20:18:24,494 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 20:18:25,575 - INFO - Task result: 67885e61aa79b9f32fc3cbe7
2025-01-15 20:18:25,575 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 20:18:25,581 - ERROR - Exception calling application: send_model_to_l2_async() takes 1 positional argument but 421642 were given
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 125, in SendAggregatedWeights
    send_model_to_l2_async.apply_async(updated_model_weights)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: send_model_to_l2_async() takes 1 positional argument but 421642 were given
2025-01-15 20:59:11,873 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 20:59:33,955 - INFO - Received aggregated weights with version: 0
2025-01-15 20:59:33,974 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 20:59:35,069 - INFO - Task result: 67886806aa79b9f32fc3cbe9
2025-01-15 20:59:35,069 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 20:59:35,069 - INFO - Contents of updated_model_weights: [0.276418536901474, -0.06673070043325424, 0.21480342745780945, 0.004255454055964947, 0.3051377534866333, -0.021841049194335938, -0.277625173330307, 0.03024125099182129, 0.11543973535299301, -0.00873764418065548]...
2025-01-15 20:59:35,069 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 20:59:35,075 - ERROR - Exception calling application: send_model_to_l2_async() takes 1 positional argument but 421642 were given
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 134, in SendAggregatedWeights
    send_model_to_l2_async.apply_async(updated_model_weights)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/task.py", line 559, in apply_async
    check_arguments(*(args or ()), **(kwargs or {}))
TypeError: send_model_to_l2_async() takes 1 positional argument but 421642 were given
2025-01-15 21:02:54,206 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:03:12,485 - INFO - Received aggregated weights with version: 0
2025-01-15 21:03:12,605 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:03:13,682 - INFO - Task result: 678868e1aa79b9f32fc3cbeb
2025-01-15 21:03:13,682 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:03:13,683 - INFO - Contents of updated_model_weights: [0.276418536901474, -0.06673070043325424, 0.21480342745780945, 0.004255454055964947, 0.3051377534866333, -0.021841049194335938, -0.277625173330307, 0.03024125099182129, 0.11543973535299301, -0.00873764418065548]...
2025-01-15 21:03:13,683 - DEBUG - 
def send_model_to_l2_async(updated_model_weights_l2):
    return 1

2025-01-15 21:07:07,121 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:07:07,121 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:07:07,121 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:07:07,122 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:07:07,123 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:07:07,123 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:10:59,908 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:11:38,201 - INFO - Received aggregated weights with version: 0
2025-01-15 21:11:38,300 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:11:39,325 - INFO - Task result: 67886adbe359d5c904f8b664
2025-01-15 21:11:39,325 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:11:39,325 - INFO - Contents of updated_model_weights: [-0.18230681121349335, 0.32586270570755005, -0.09184873104095459, 0.06041765213012695, -0.2943582236766815, -0.004678130149841309, -0.2857557237148285, 0.12920448184013367, 0.2459772527217865, 0.30561932921409607]...
2025-01-15 21:11:39,325 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:42:59,787 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:43:10,046 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:43:10,046 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:43:10,046 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:43:10,047 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:43:10,048 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:43:19,408 - INFO - Received aggregated weights with version: 0
2025-01-15 21:43:19,526 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:43:20,645 - INFO - Task result: 67887248cc51355fdec768da
2025-01-15 21:43:20,646 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:43:20,646 - INFO - Contents of updated_model_weights: [-0.18230681121349335, 0.32586270570755005, -0.09184873104095459, 0.06041765213012695, -0.2943582236766815, -0.004678130149841309, -0.2857557237148285, 0.12920448184013367, 0.2459772527217865, 0.30561932921409607]...
2025-01-15 21:43:20,647 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:44:33,142 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:44:33,143 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:44:33,143 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:44:33,143 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:44:33,143 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:44:33,143 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:44:33,144 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:44:33,144 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:44:33,144 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:44:33,144 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:44:33,144 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:44:41,172 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:45:08,581 - INFO - Received aggregated weights with version: 0
2025-01-15 21:45:08,701 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:45:09,736 - INFO - Task result: 678872b56adf8f07c0b56535
2025-01-15 21:45:09,736 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:45:09,737 - INFO - Contents of updated_model_weights: [0.05583151429891586, 0.10079892724752426, 0.08788120746612549, -0.060609739273786545, 0.061591826379299164, 0.04758600518107414, -0.08573436737060547, 0.28304868936538696, -0.24075746536254883, -0.1331307590007782]...
2025-01-15 21:45:09,737 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:46:22,447 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:46:22,447 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:46:22,447 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:46:22,448 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:46:22,449 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:46:26,497 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:46:44,923 - INFO - Received aggregated weights with version: 0
2025-01-15 21:46:44,942 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:46:46,002 - INFO - Task result: 67887315771076098d04b02f
2025-01-15 21:46:46,002 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:46:46,002 - INFO - Contents of updated_model_weights: [-0.2068801373243332, -0.2500781714916229, -0.2965257167816162, -0.32639139890670776, 0.0703691691160202, -0.18315860629081726, 0.09121605008840561, 0.07444524765014648, -0.13179437816143036, -0.16674470901489258]...
2025-01-15 21:46:46,002 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:54:29,169 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:54:29,169 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:54:29,170 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:54:29,171 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:54:29,171 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:54:37,457 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:55:01,967 - INFO - Received aggregated weights with version: 0
2025-01-15 21:55:01,986 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:55:03,110 - INFO - Task result: 67887506fb5e0ec4ec6b8d99
2025-01-15 21:55:03,110 - INFO - Type of updated_model_weights: <class 'list'>
2025-01-15 21:55:03,111 - INFO - Contents of updated_model_weights: [0.10874132812023163, -0.060861825942993164, -0.07445339858531952, 0.27774059772491455, 0.19656440615653992, 0.32590803503990173, 0.2885189950466156, -0.1566423624753952, 0.08514460176229477, 0.27705150842666626]...
2025-01-15 21:55:03,111 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:59:06,334 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 21:59:18,744 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 21:59:18,745 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 21:59:18,746 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 21:59:18,746 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 21:59:18,746 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 21:59:18,746 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 21:59:43,501 - INFO - Received aggregated weights with version: 0
2025-01-15 21:59:43,611 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 21:59:44,665 - INFO - Task result: 67887620c39073a285aa9f6a
2025-01-15 21:59:44,665 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:03:15,193 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 22:03:22,614 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 22:03:22,615 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 22:03:22,615 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 22:03:22,615 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 22:03:22,615 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:03:22,615 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 22:03:22,616 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 22:03:22,616 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 22:03:22,616 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 22:03:22,616 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 22:03:22,616 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 22:03:41,836 - INFO - Received aggregated weights with version: 0
2025-01-15 22:03:41,856 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 22:03:42,914 - INFO - Task result: 6788770eaa2ad6fe0423a9f1
2025-01-15 22:03:42,915 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:09:42,588 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 22:09:42,589 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 22:09:42,590 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 22:09:42,590 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:09:42,590 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 22:09:42,590 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 22:09:46,895 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 22:10:06,060 - INFO - Received aggregated weights with version: 0
2025-01-15 22:10:06,079 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 22:10:07,160 - INFO - Task result: 6788788ea51924db3caaf271
2025-01-15 22:10:07,161 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:19:34,895 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 22:19:43,203 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 22:19:43,203 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 22:19:43,204 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 22:19:43,205 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 22:19:43,205 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 22:19:43,205 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 22:20:04,845 - INFO - Received aggregated weights with version: 0
2025-01-15 22:20:04,866 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 22:20:05,966 - INFO - Task result: 67887ae5c42e74d3e008a503
2025-01-15 22:20:05,966 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:26:58,554 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 22:27:06,057 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 22:27:06,057 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 22:27:06,057 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 22:27:06,058 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 22:27:06,059 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 22:27:33,527 - INFO - Received aggregated weights with version: 0
2025-01-15 22:27:33,547 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 22:27:34,695 - INFO - Task result: 67887ca6af52f9680ecf454f
2025-01-15 22:27:34,695 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:29:25,318 - INFO - Top layer aggregator server started on port 8082.
2025-01-15 22:29:31,787 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-15 22:29:31,788 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-15 22:29:31,789 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-15 22:29:31,789 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-15 22:29:31,789 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-15 22:29:31,789 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-15 22:29:57,027 - INFO - Received aggregated weights with version: 0
2025-01-15 22:29:57,048 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-15 22:29:58,171 - INFO - Task result: 67887d352b6dc2912c4e422d
2025-01-15 22:29:58,172 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-16 20:18:13,872 - INFO - Top layer aggregator server started on port 8082.
2025-01-16 20:20:06,782 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-16 20:20:06,782 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-16 20:20:06,782 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-16 20:20:06,782 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-16 20:20:06,783 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-16 20:21:06,640 - INFO - Received aggregated weights with version: 0
2025-01-16 20:21:06,881 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-16 20:21:08,092 - INFO - Task result: 6789b083fcb829b174faba18
2025-01-16 20:21:08,092 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-16 23:20:37,550 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-16 23:20:37,550 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-16 23:20:37,550 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-16 23:20:37,551 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-16 23:20:37,552 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-16 23:55:37,370 - INFO - Top layer aggregator server started on port 8082.
2025-01-16 23:56:10,761 - INFO - Top layer aggregator server started on port 8082.
2025-01-16 23:56:33,069 - INFO - Received aggregated weights with version: 0
2025-01-16 23:56:33,088 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-16 23:56:34,268 - INFO - Task result: 6789e301c7c4af20f43df19b
2025-01-16 23:56:34,269 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-17 15:18:23,945 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-17 15:18:23,952 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-17 15:18:23,952 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-17 15:18:23,953 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-17 15:18:23,954 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-17 15:18:23,954 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-17 15:18:23,955 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-17 15:18:23,956 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-17 15:18:23,956 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-17 15:18:23,957 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-17 15:18:23,958 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-17 15:19:37,906 - INFO - Top layer aggregator server started on port 8082.
2025-01-18 15:16:20,866 - INFO - Top layer aggregator server started on port 8082.
2025-01-18 15:20:44,860 - INFO - Received aggregated weights with version: 0
2025-01-18 15:20:45,152 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-18 15:21:10,395 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-18 15:21:10,395 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-18 15:21:10,395 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-18 15:21:10,395 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-18 15:21:10,395 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-18 15:21:10,396 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-18 15:21:12,487 - INFO - Task result: 678c0d38e6199c29ace06d3a
2025-01-18 15:21:12,487 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-18 15:21:29,534 - INFO - Received aggregated weights with version: 0
2025-01-18 15:21:29,624 - INFO - Applied FedAvg and updated the global model. Current version: 2
2025-01-18 15:21:30,856 - INFO - Task result: 678c0d4ae6199c29ace06d3c
2025-01-19 02:03:39,524 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:03:39,525 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:03:39,526 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:03:39,526 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:03:39,526 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:03:39,526 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:03:57,790 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:04:25,048 - INFO - Received aggregated weights with version: 0
2025-01-19 02:04:25,131 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:04:26,371 - INFO - Task result: 678ca3fa8c6b96533c85e24e
2025-01-19 02:04:26,371 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:06:46,927 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:06:46,927 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:06:46,928 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:06:46,929 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:06:46,929 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:06:46,929 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:07:10,557 - INFO - Received aggregated weights with version: 0
2025-01-19 02:07:10,646 - INFO - Applied FedAvg and updated the global model. Current version: 2
2025-01-19 02:07:11,811 - INFO - Task result: 678ca49fb5df76c86a523208
2025-01-19 02:12:59,787 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:12:59,796 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:12:59,796 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:12:59,796 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:12:59,796 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:12:59,797 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:13:06,417 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:13:25,239 - INFO - Received aggregated weights with version: 0
2025-01-19 02:13:25,258 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:13:26,467 - INFO - Task result: 678ca6163cecd267c8b1f927
2025-01-19 02:13:26,467 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:18:50,222 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:19:02,260 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:19:02,261 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:19:02,261 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:19:02,261 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:19:02,261 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:19:02,261 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:19:02,262 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:19:02,262 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:19:02,262 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:19:02,262 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:19:02,262 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:19:22,382 - INFO - Received aggregated weights with version: 0
2025-01-19 02:19:22,402 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:19:23,585 - INFO - Task result: 678ca77bc05f8fb9c8bc7d5b
2025-01-19 02:19:23,586 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:22:46,526 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:22:53,582 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:22:53,582 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:22:53,583 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:22:53,583 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:22:53,583 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:22:53,583 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:22:53,584 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:22:53,584 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:22:53,584 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:22:53,584 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:22:53,585 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:23:17,928 - INFO - Received aggregated weights with version: 0
2025-01-19 02:23:18,055 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:23:19,224 - INFO - Task result: 678ca8662827e8e27eabc391
2025-01-19 02:23:19,225 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:28:45,287 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:28:55,569 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:28:55,569 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:28:55,570 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:28:55,571 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:28:55,571 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:28:55,571 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:29:16,185 - INFO - Received aggregated weights with version: 0
2025-01-19 02:29:16,268 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:29:17,427 - INFO - Task result: 678ca9cdb6959ad8ace884dc
2025-01-19 02:29:17,428 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:30:59,975 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:31:08,365 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:31:08,365 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:31:08,365 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:31:08,365 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:31:08,366 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:31:08,367 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:31:28,937 - INFO - Received aggregated weights with version: 0
2025-01-19 02:31:29,049 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:31:30,182 - INFO - Task result: 678caa51776c85930be87eb0
2025-01-19 02:31:30,183 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:32:22,320 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:32:27,483 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:32:27,484 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:32:27,485 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:32:27,485 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:32:27,485 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:32:27,485 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:32:49,770 - INFO - Received aggregated weights with version: 0
2025-01-19 02:32:49,793 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:32:50,950 - INFO - Task result: 678caaa291fef1afade12971
2025-01-19 02:32:50,950 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:34:17,390 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:34:17,391 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:34:17,391 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:34:17,391 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:34:17,391 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:34:17,391 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:34:17,392 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:34:17,392 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:34:17,392 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:34:17,392 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:34:17,392 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:34:23,118 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:34:41,879 - INFO - Received aggregated weights with version: 0
2025-01-19 02:34:41,898 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:34:43,024 - INFO - Task result: 678cab128d8652181ad4b348
2025-01-19 02:34:43,025 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:42:57,672 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:42:57,673 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:42:57,673 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:42:57,673 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:42:57,673 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:42:57,673 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:43:03,614 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:43:22,194 - INFO - Received aggregated weights with version: 0
2025-01-19 02:43:22,292 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:43:23,434 - INFO - Task result: 678cad1b2e221c09d7ae963c
2025-01-19 02:43:23,435 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:46:25,804 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 02:46:25,804 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 02:46:25,805 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 02:46:25,806 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 02:46:25,806 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 02:46:25,806 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 02:46:29,414 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 02:46:47,502 - INFO - Received aggregated weights with version: 0
2025-01-19 02:46:47,627 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 02:46:48,784 - INFO - Task result: 678cade8b6811ae18a5f7f42
2025-01-19 02:46:48,785 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:20:03,108 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:20:12,651 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:20:12,651 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:20:12,651 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:20:12,652 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:20:12,653 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:20:12,653 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:20:41,203 - ERROR - Exception calling application: local variable 'request_counter' referenced before assignment
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 96, in SendAggregatedWeights
    request_counter += 1
UnboundLocalError: local variable 'request_counter' referenced before assignment
2025-01-19 03:21:22,748 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:21:34,845 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:21:34,845 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:21:34,846 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:21:34,847 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:21:34,847 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:21:34,847 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:21:53,378 - INFO - Received aggregated weights with version: 0
2025-01-19 03:21:53,400 - ERROR - Exception calling application: name 'time' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 113, in SendAggregatedWeights
    start_time = time.time()
NameError: name 'time' is not defined
2025-01-19 03:22:25,322 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:22:43,652 - INFO - Received aggregated weights with version: 0
2025-01-19 03:22:43,765 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:22:43,778 - ERROR - Exception calling application: client_training_time
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 131, in SendAggregatedWeights
    "Client_training_time": request.client_training_time,
AttributeError: client_training_time
2025-01-19 03:26:11,155 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:26:38,406 - INFO - Received aggregated weights with version: 0
2025-01-19 03:26:38,519 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:26:38,532 - ERROR - Exception calling application: client_training_time
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 131, in SendAggregatedWeights
    "Client_training_time": request.client_training_time,
AttributeError: client_training_time
2025-01-19 03:27:07,103 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:27:30,808 - INFO - Received aggregated weights with version: 0
2025-01-19 03:27:30,930 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:27:30,954 - ERROR - Exception calling application: name 'datetime' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 131, in SendAggregatedWeights
    "DateTime": datetime.utcnow(),
NameError: name 'datetime' is not defined
2025-01-19 03:28:04,358 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:28:22,365 - INFO - Received aggregated weights with version: 0
2025-01-19 03:28:22,385 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:28:23,563 - INFO - Task result: 678cb7a75eb277b1bf23b2e0
2025-01-19 03:28:23,564 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:31:18,692 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:31:28,105 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:31:28,105 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:31:28,106 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:31:28,107 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:31:28,107 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:31:28,107 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:31:47,233 - INFO - Received aggregated weights with version: 0
2025-01-19 03:31:47,253 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:31:48,414 - INFO - Task result: 678cb87452a7d18eddf9c2ef
2025-01-19 03:31:48,414 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:33:31,306 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:34:54,456 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:34:54,457 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:34:54,458 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:34:54,458 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:34:54,458 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:34:54,458 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:34:58,868 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:35:17,237 - INFO - Received aggregated weights with version: 0
2025-01-19 03:35:17,334 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:35:18,459 - INFO - Task result: 678cb94648f74a968d91bed5
2025-01-19 03:35:18,460 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:41:29,593 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:41:29,593 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:41:29,593 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:41:29,593 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:41:29,593 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:41:29,594 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:41:33,031 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:41:51,516 - INFO - Received aggregated weights with version: 0
2025-01-19 03:41:51,516 - WARNING - Client version 0 is behind the server version 1. Fetching latest weights from MongoDB.
2025-01-19 03:41:51,635 - INFO - Latest entry ID: 678cbace5eee4cf5bed3d564, Version: 2
2025-01-19 03:41:51,677 - INFO - Loaded latest model weights from MongoDB.
2025-01-19 03:41:51,782 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:41:52,860 - INFO - Task result: 678cbad0221f3b44133b20da
2025-01-19 03:41:52,861 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:41:53,256 - INFO - Model weights sent successfully to L2 server.
2025-01-19 03:46:27,489 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:46:27,489 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-01-19 03:46:27,489 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-01-19 03:46:27,489 - DEBUG - 
def backend_cleanup():
    return 1

2025-01-19 03:46:27,489 - DEBUG - 
def xmap(task, it):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-01-19 03:46:27,490 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-01-19 03:46:33,415 - INFO - Top layer aggregator server started on port 8082.
2025-01-19 03:46:52,027 - INFO - Received aggregated weights with version: 1
2025-01-19 03:46:52,027 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-01-19 03:46:52,146 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-01-19 03:46:53,182 - INFO - Task result: 678cbbfcc7a27f9d80a75872
2025-01-19 03:46:53,183 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-01-19 03:46:53,548 - INFO - Model weights sent successfully to L2 server.
2025-01-19 03:47:34,110 - INFO - Received aggregated weights with version: 3
2025-01-19 03:47:34,110 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-01-19 03:47:34,191 - INFO - Latest entry ID: 678cbc25bd5a61955761ece8, Version: 3
2025-01-19 03:47:34,215 - INFO - Loaded latest model weights from MongoDB.
2025-01-19 03:47:34,237 - INFO - Applied FedAvg and updated the global model. Current version: 2
2025-01-19 03:47:35,262 - INFO - Task result: 678cbc26c7a27f9d80a75874
2025-01-19 03:47:35,614 - INFO - Model weights sent successfully to L2 server.
2025-02-10 20:20:48,238 - INFO - Top layer aggregator server started on port 8082.
2025-02-10 20:23:02,583 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-10 20:23:02,583 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-10 20:23:02,583 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-10 20:23:02,584 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-10 20:23:02,584 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-10 20:23:02,584 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-10 20:23:02,584 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-10 20:23:02,585 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-10 20:23:02,585 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-10 20:23:02,585 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-10 20:23:02,585 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-10 20:26:58,670 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-10 20:26:58,696 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-10 20:26:58,697 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-10 20:26:58,698 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-10 20:26:58,699 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-10 20:26:58,700 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-10 20:26:58,701 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-10 20:26:58,702 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-10 20:26:58,703 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-10 20:26:58,704 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-10 20:26:58,705 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-10 20:27:23,974 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-10 20:27:23,975 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-10 20:27:23,976 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-10 20:27:23,976 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-10 20:27:23,976 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-10 20:27:23,976 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-10 20:40:21,220 - INFO - Top layer aggregator server started on port 8082.
2025-02-10 20:40:52,124 - INFO - Received aggregated weights with version: 3
2025-02-10 20:40:52,124 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-10 20:40:52,259 - INFO - Latest entry ID: 678cbc26c7a27f9d80a75874, Version: 2
2025-02-10 20:40:52,303 - INFO - Loaded latest model weights from MongoDB.
2025-02-10 20:40:52,327 - ERROR - Exception calling application: 'list' object has no attribute 'state_dict'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.aggregated_weights, self.sample_counts)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 4, in fed_avg
    new_state_dict = global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
2025-02-10 20:58:29,056 - INFO - Top layer aggregator server started on port 8082.
2025-02-10 21:01:15,553 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-10 21:01:15,553 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-10 21:01:15,554 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-10 21:01:15,554 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-10 21:01:15,554 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-10 21:01:15,554 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-10 21:01:15,554 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-10 21:01:15,555 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-10 21:01:15,555 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-10 21:01:15,555 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-10 21:01:15,555 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-10 21:01:22,663 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:18:24,011 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-12 18:18:24,128 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-12 18:18:24,129 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-12 18:18:24,130 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-12 18:18:24,132 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-12 18:18:24,133 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-12 18:18:24,134 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-12 18:18:24,135 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-12 18:18:24,136 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-12 18:18:24,137 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-12 18:18:24,137 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-12 18:23:00,654 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:25:18,262 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:25:40,889 - INFO - Received aggregated weights with version: 3
2025-02-12 18:25:40,890 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:25:40,977 - INFO - Latest entry ID: 678cbc26c7a27f9d80a75874, Version: 2
2025-02-12 18:25:41,019 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:25:41,045 - ERROR - Exception calling application: 'list' object has no attribute 'state_dict'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.aggregated_weights, self.sample_counts)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 4, in fed_avg
    new_state_dict = global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
2025-02-12 18:29:53,849 - INFO - Received aggregated weights with version: 4
2025-02-12 18:29:53,849 - WARNING - Client version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:29:53,924 - INFO - Latest entry ID: 678cbc26c7a27f9d80a75874, Version: 2
2025-02-12 18:29:53,951 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:29:53,976 - ERROR - Exception calling application: 'list' object has no attribute 'state_dict'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.aggregated_weights, self.sample_counts)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 4, in fed_avg
    new_state_dict = global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
2025-02-12 18:37:52,513 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:38:15,433 - INFO - Received aggregated weights with version: 3
2025-02-12 18:38:15,433 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:38:15,520 - INFO - Latest entry ID: 678cbc26c7a27f9d80a75874, Version: 2
2025-02-12 18:38:15,566 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:38:15,601 - ERROR - Exception calling application: 'list' object has no attribute 'state_dict'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.aggregated_weights, self.sample_counts)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 4, in fed_avg
    new_state_dict = global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
2025-02-12 18:39:58,232 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:40:17,086 - INFO - Received aggregated weights with version: 3
2025-02-12 18:40:17,086 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:40:17,182 - INFO - Latest entry ID: 67ad31609e49506e69ba87c8, Version: 3
2025-02-12 18:40:17,227 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:40:17,255 - ERROR - Exception calling application: 'list' object has no attribute 'state_dict'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.aggregated_weights, self.sample_counts)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 4, in fed_avg
    new_state_dict = global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
2025-02-12 18:53:57,460 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:54:18,949 - INFO - Received aggregated weights with version: 4
2025-02-12 18:54:18,949 - WARNING - Client version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:54:19,081 - INFO - Latest entry ID: 67ad34a99e49506e69ba87ca, Version: 4
2025-02-12 18:54:19,126 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:54:19,159 - ERROR - Exception calling application: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.global_model, self.aggregated_weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 10, in fed_avg
    if key_suffix in w:
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/torch/_tensor.py", line 985, in __contains__
    raise RuntimeError(
RuntimeError: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
2025-02-12 18:56:35,760 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 18:56:54,643 - INFO - Received aggregated weights with version: 5
2025-02-12 18:56:54,643 - WARNING - Client version 5 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 18:56:54,728 - INFO - Latest entry ID: 67ad35459e49506e69ba87cc, Version: 5
2025-02-12 18:56:54,772 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 18:56:55,352 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 18:56:55,353 - ERROR - Exception calling application: 'collections.OrderedDict' object has no attribute 'parameters'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 165, in SendAggregatedWeights
    updated_model_weights = self._flatten_weights(self.global_model)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 206, in _flatten_weights
    for param in model.parameters():
AttributeError: 'collections.OrderedDict' object has no attribute 'parameters'
2025-02-12 18:59:49,846 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:00:07,880 - INFO - Received aggregated weights with version: 6
2025-02-12 19:00:07,880 - WARNING - Client version 6 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:00:08,010 - INFO - Latest entry ID: 67ad36069e49506e69ba87ce, Version: 6
2025-02-12 19:00:08,044 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:00:08,592 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 19:00:08,592 - ERROR - Exception calling application: name 'OrderedDict' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 165, in SendAggregatedWeights
    updated_model_weights = self._flatten_weights(self.global_model)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 204, in _flatten_weights
    if isinstance(model_weights, OrderedDict):
NameError: name 'OrderedDict' is not defined
2025-02-12 19:00:57,431 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:01:15,678 - INFO - Received aggregated weights with version: 7
2025-02-12 19:01:15,678 - WARNING - Client version 7 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:01:15,765 - INFO - Latest entry ID: 67ad364a9e49506e69ba87d0, Version: 7
2025-02-12 19:01:15,810 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:01:16,338 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 19:01:16,547 - ERROR - Exception calling application: Object of type Tensor is not JSON serializable
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Tensor is not JSON serializable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 178, in SendAggregatedWeights
    task_result = app_celery.send_task('l3_celery_tasks.store_aggregated_weights_task', args=[updated_model_weights_payload, model_name])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 799, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/amqp.py", line 518, in send_task_message
    ret = producer.publish(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 175, in publish
    body, content_type, content_encoding = self._prepare(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 268, in _prepare
    body) = dumps(body, serializer=serializer)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 219, in dumps
    with _reraise_errors(EncodeError):
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 45, in _reraise_errors
    reraise(wrapper, wrapper(exc), sys.exc_info()[2])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/exceptions.py", line 34, in reraise
    raise value.with_traceback(tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
kombu.exceptions.EncodeError: Object of type Tensor is not JSON serializable
2025-02-12 19:05:41,642 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:06:00,564 - INFO - Received aggregated weights with version: 8
2025-02-12 19:06:00,565 - WARNING - Client version 8 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:06:00,692 - INFO - Latest entry ID: 67ad37679e49506e69ba87d2, Version: 8
2025-02-12 19:06:00,733 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:06:01,257 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 19:06:01,257 - ERROR - Exception calling application: 'int' object has no attribute 'cpu'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 177, in SendAggregatedWeights
    updated_model_weights_payload = {k: v.cpu().numpy().tolist() for k, v in updated_model_weights_payload.items()}
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 177, in <dictcomp>
    updated_model_weights_payload = {k: v.cpu().numpy().tolist() for k, v in updated_model_weights_payload.items()}
AttributeError: 'int' object has no attribute 'cpu'
2025-02-12 19:08:31,893 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:08:50,181 - INFO - Received aggregated weights with version: 9
2025-02-12 19:08:50,181 - WARNING - Client version 9 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:08:50,268 - INFO - Latest entry ID: 67ad38119e49506e69ba87d4, Version: 9
2025-02-12 19:08:50,301 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:08:50,842 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 19:08:50,878 - ERROR - Exception calling application: Object of type Tensor is not JSON serializable
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Tensor is not JSON serializable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 179, in SendAggregatedWeights
    task_result = app_celery.send_task('l3_celery_tasks.store_aggregated_weights_task', args=[updated_model_weights_payload, model_name])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 799, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/amqp.py", line 518, in send_task_message
    ret = producer.publish(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 175, in publish
    body, content_type, content_encoding = self._prepare(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 268, in _prepare
    body) = dumps(body, serializer=serializer)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 219, in dumps
    with _reraise_errors(EncodeError):
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 45, in _reraise_errors
    reraise(wrapper, wrapper(exc), sys.exc_info()[2])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/exceptions.py", line 34, in reraise
    raise value.with_traceback(tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
kombu.exceptions.EncodeError: Object of type Tensor is not JSON serializable
2025-02-12 19:11:38,346 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:11:56,759 - INFO - Received aggregated weights with version: 10
2025-02-12 19:11:56,759 - WARNING - Client version 10 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:11:56,885 - INFO - Latest entry ID: 67ad38cb9e49506e69ba87d6, Version: 10
2025-02-12 19:11:56,929 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:11:57,468 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-12 19:11:57,468 - INFO - [tensor([ 0.0152,  0.1617,  0.0769,  0.3018,  0.2105,  0.1084,  0.3278,  0.3071,
         0.1657,  0.0991,  0.1345,  0.2310,  0.2045,  0.2232,  0.1998, -0.0837,
         0.0295,  0.0751,  0.2155, -0.2444, -0.1996, -0.0172, -0.2794,  0.2098,
         0.0526,  0.2739,  0.0752,  0.1792,  0.0877, -0.1970,  0.2445, -0.0092,
         0.2011, -0.2134,  0.1041,  0.0798, -0.0487, -0.1933, -0.2838,  0.1858,
         0.2079, -0.2158, -0.2136, -0.3219, -0.1696,  0.1980, -0.3142, -0.2075,
         0.3247, -0.2179,  0.2142,  0.0338, -0.0200,  0.0991, -0.0186,  0.0826,
        -0.2755, -0.1568, -0.2754, -0.2404,  0.1510, -0.0532,  0.1609, -0.1415,
         0.2316, -0.2252,  0.2386,  0.3156,  0.1126,  0.3237,  0.1466, -0.1187,
        -0.3087,  0.1121,  0.2664, -0.3304,  0.0088,  0.2454,  0.1105, -0.2732,
        -0.2266,  0.3199,  0.0490,  0.0646,  0.2803, -0.1318, -0.2920, -0.2532,
        -0.3177,  0.0419,  0.0741,  0.2164,  0.0664,  0.2677, -0.2441, -0.3021,
         0.3177, -0.1627, -0.0568,  0.0642, -0.2441, -0.0882, -0.1691, -0.1707,
        -0.2767,  0.2362, -0.0772, -0.2167, -0.2282,  0.0868, -0.3018,  0.2651,
        -0.0497, -0.3042, -0.2181,  0.2987,  0.1497, -0.1092,  0.0084,  0.0369,
         0.0893,  0.0767,  0.0572,  0.0992, -0.0919, -0.0788,  0.1884, -0.0388,
        -0.3093, -0.0364, -0.1323,  0.1675,  0.2595, -0.2760, -0.2422,  0.3034,
        -0.0786, -0.0879, -0.0051,  0.0057,  0.0968,  0.1840, -0.2612, -0.3019,
        -0.1230,  0.0481,  0.1735, -0.1926, -0.2625,  0.2925, -0.2876, -0.2459,
         0.1318,  0.0943, -0.2254, -0.1197,  0.2747,  0.2123, -0.1283, -0.0890,
         0.0262,  0.2343,  0.0578,  0.0809,  0.1926,  0.1853, -0.1866,  0.0021,
        -0.2554,  0.2279,  0.2505,  0.0730, -0.2472,  0.2951,  0.2391, -0.2673,
        -0.0307,  0.2970, -0.1105, -0.1087, -0.0432,  0.2548, -0.1836,  0.2850,
         0.2325, -0.1353, -0.2927,  0.0275,  0.0307,  0.0934, -0.2348, -0.1482,
        -0.2841,  0.0938,  0.2110,  0.3273,  0.0683,  0.1749,  0.2290,  0.3016,
        -0.2942, -0.2215, -0.1816, -0.1588, -0.2098, -0.2167, -0.2811, -0.0952,
        -0.1958, -0.2812, -0.3266, -0.1586,  0.3299,  0.1937, -0.2103,  0.1957,
         0.0048, -0.2560, -0.0616, -0.3096, -0.3326,  0.0865,  0.0036, -0.2985,
        -0.3202, -0.1215,  0.0418,  0.1816,  0.0291,  0.0580,  0.1678,  0.0787,
        -0.1477,  0.2568,  0.2514, -0.2415,  0.3152,  0.2523, -0.3166,  0.0561,
        -0.0286, -0.3096, -0.0094, -0.1218, -0.2843, -0.0737,  0.1073,  0.2159,
         0.1890,  0.2150, -0.2877,  0.0594,  0.1880,  0.2612,  0.1574,  0.0538,
         0.2478, -0.2759, -0.1832,  0.1831,  0.2329, -0.0409,  0.2459,  0.2229,
        -0.0588,  0.0606, -0.1447,  0.0621, -0.0162,  0.0818, -0.1432, -0.1798,
         0.2503, -0.0395, -0.1121,  0.2681, -0.3281, -0.1620, -0.0121,  0.0251,
        -0.2947, -0.1687, -0.0147,  0.1871, -0.2682, -0.3320,  0.2060, -0.2697]), tensor([ 0.1206,  0.0357, -0.0983, -0.0793, -0.2201, -0.1271,  0.1754, -0.2442,
         0.2159,  0.1939,  0.1109, -0.0135,  0.0816,  0.2021, -0.1481, -0.1648,
         0.1594,  0.0357, -0.2189,  0.3133, -0.2479, -0.3218,  0.1806,  0.0195,
         0.3094,  0.0170,  0.2690, -0.1075, -0.0093, -0.0651, -0.0140, -0.1217]), tensor([-0.0575,  0.0226, -0.0490,  ..., -0.0332,  0.0437,  0.0275]), tensor([-0.0272,  0.0560, -0.0349, -0.0537, -0.0021, -0.0473,  0.0351, -0.0199,
         0.0478, -0.0131,  0.0579, -0.0100,  0.0087,  0.0363,  0.0082, -0.0450,
         0.0583, -0.0406,  0.0417, -0.0579, -0.0312, -0.0442,  0.0384,  0.0431,
        -0.0554, -0.0331,  0.0018,  0.0070, -0.0524,  0.0520,  0.0124, -0.0487,
         0.0075,  0.0365, -0.0187, -0.0309, -0.0544,  0.0220,  0.0150,  0.0540,
         0.0575,  0.0279, -0.0483,  0.0460,  0.0143,  0.0525, -0.0526,  0.0230,
        -0.0415,  0.0159, -0.0176, -0.0015,  0.0121, -0.0473,  0.0380, -0.0207,
        -0.0045,  0.0213, -0.0426,  0.0451, -0.0409,  0.0193, -0.0484,  0.0304]), tensor([ 1.3243e-02, -8.3460e-03,  9.1552e-03,  ...,  1.7689e-02,
         2.2545e-03, -8.4598e-05]), tensor([-0.0133,  0.0017, -0.0002,  0.0132, -0.0034,  0.0166,  0.0168,  0.0107,
        -0.0097, -0.0176,  0.0055,  0.0044,  0.0081, -0.0171, -0.0161, -0.0024,
         0.0008, -0.0014, -0.0005, -0.0056,  0.0178, -0.0034, -0.0078, -0.0142,
        -0.0144,  0.0004,  0.0130,  0.0012, -0.0003, -0.0145, -0.0066, -0.0088,
        -0.0097,  0.0055,  0.0114,  0.0050,  0.0074,  0.0144, -0.0144,  0.0077,
         0.0056, -0.0151,  0.0070,  0.0171,  0.0125, -0.0068,  0.0105,  0.0117,
        -0.0091, -0.0016,  0.0103, -0.0117,  0.0038,  0.0079,  0.0101, -0.0086,
        -0.0035,  0.0033,  0.0122, -0.0054,  0.0135,  0.0111, -0.0176, -0.0129,
         0.0046, -0.0124,  0.0056,  0.0169, -0.0138,  0.0138,  0.0143,  0.0047,
        -0.0093,  0.0032, -0.0034, -0.0166, -0.0105, -0.0022,  0.0093,  0.0084,
         0.0035, -0.0017,  0.0139, -0.0070, -0.0035, -0.0064,  0.0090, -0.0133,
        -0.0012, -0.0172,  0.0090,  0.0162,  0.0089,  0.0139,  0.0045, -0.0009,
        -0.0149,  0.0017,  0.0154, -0.0135, -0.0082,  0.0039, -0.0104, -0.0107,
         0.0019,  0.0094, -0.0005, -0.0040, -0.0132, -0.0140,  0.0014,  0.0022,
        -0.0095, -0.0142,  0.0030, -0.0073,  0.0001, -0.0121, -0.0153, -0.0016,
        -0.0103,  0.0039,  0.0106, -0.0033,  0.0062,  0.0016,  0.0120, -0.0175]), tensor([-0.0098, -0.0218, -0.0352,  ...,  0.0381, -0.0362,  0.0741]), tensor([-0.0313,  0.0137,  0.0476, -0.0045,  0.0875, -0.0173, -0.0103, -0.0083,
        -0.0095, -0.0800])]
2025-02-12 19:11:57,526 - ERROR - Exception calling application: Object of type Tensor is not JSON serializable
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Tensor is not JSON serializable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 179, in SendAggregatedWeights
    task_result = app_celery.send_task('l3_celery_tasks.store_aggregated_weights_task', args=[updated_model_weights_payload, model_name])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/base.py", line 799, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/celery/app/amqp.py", line 518, in send_task_message
    ret = producer.publish(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 175, in publish
    body, content_type, content_encoding = self._prepare(
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/messaging.py", line 268, in _prepare
    body) = dumps(body, serializer=serializer)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 219, in dumps
    with _reraise_errors(EncodeError):
  File "/usr/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 45, in _reraise_errors
    reraise(wrapper, wrapper(exc), sys.exc_info()[2])
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/exceptions.py", line 34, in reraise
    raise value.with_traceback(tb)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 41, in _reraise_errors
    yield
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/serialization.py", line 220, in dumps
    payload = encoder(data)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 57, in dumps
    return _dumps(s, cls=cls, **dict(default_kwargs, **kwargs))
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/kombu/utils/json.py", line 45, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
kombu.exceptions.EncodeError: Object of type Tensor is not JSON serializable
2025-02-12 19:16:53,277 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:17:11,327 - INFO - Received aggregated weights with version: 11
2025-02-12 19:17:11,327 - WARNING - Client version 11 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:17:11,415 - INFO - Latest entry ID: 67ad3a069e49506e69ba87d8, Version: 11
2025-02-12 19:17:11,449 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:17:11,475 - ERROR - Exception calling application: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.global_model, self.aggregated_weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 10, in fed_avg
    if key_suffix in w:
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/torch/_tensor.py", line 985, in __contains__
    raise RuntimeError(
RuntimeError: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
2025-02-12 19:19:08,979 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:19:27,174 - INFO - Received aggregated weights with version: 12
2025-02-12 19:19:27,175 - WARNING - Client version 12 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:19:27,304 - INFO - Latest entry ID: 67ad3a8e9e49506e69ba87da, Version: 12
2025-02-12 19:19:27,333 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:19:27,357 - ERROR - Exception calling application: 'Tensor' object has no attribute 'keys'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    self.global_model = fed_avg(self.global_model, self.aggregated_weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 10, in fed_avg
    if key_suffix in w.keys():
AttributeError: 'Tensor' object has no attribute 'keys'
2025-02-12 19:21:48,837 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:22:06,988 - INFO - Received aggregated weights with version: 13
2025-02-12 19:22:06,988 - WARNING - Client version 13 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:22:07,077 - INFO - Latest entry ID: 67ad3b2d9e49506e69ba87dc, Version: 13
2025-02-12 19:22:07,123 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 19:22:07,127 - ERROR - Exception calling application: keys
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 144, in SendAggregatedWeights
    for key, weight in zip(request.keys, request.weights):
AttributeError: keys
2025-02-12 19:31:42,248 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 19:32:00,463 - INFO - Received aggregated weights with version: 14
2025-02-12 19:32:00,463 - WARNING - Client version 14 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 19:32:00,593 - INFO - Latest entry ID: 67ad3d7f9e49506e69ba87de, Version: 14
2025-02-12 19:32:00,637 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 20:38:29,248 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-12 20:38:29,248 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-12 20:38:29,248 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-12 20:38:29,248 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-12 20:38:29,249 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-12 20:38:29,250 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-12 20:38:58,053 - INFO - Top layer aggregator server started on port 8082.
2025-02-12 20:59:52,518 - INFO - Received aggregated weights with version: 2
2025-02-12 20:59:52,544 - WARNING - Client version 2 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 20:59:52,632 - INFO - Latest entry ID: 67ad52179df9e83db4c2148b, Version: 2
2025-02-12 20:59:52,673 - INFO - Loaded latest model weights from MongoDB.
2025-02-12 21:58:31,625 - INFO - Received aggregated weights with version: 2
2025-02-12 21:58:31,625 - WARNING - Client version 2 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-12 21:58:31,730 - INFO - Latest entry ID: 67ad5fd69df9e83db4c2148d, Version: 1
2025-02-12 21:58:31,743 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 16:49:47,941 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-13 16:49:47,960 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-13 16:49:47,960 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-13 16:49:47,960 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-13 16:49:47,960 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-13 16:49:47,961 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-13 16:50:03,476 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 16:50:45,438 - INFO - Received aggregated weights with version: 2
2025-02-13 16:50:45,443 - WARNING - Client version 2 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 16:50:45,570 - INFO - Latest entry ID: 67ae6934aa7752fb4eaa1e92, Version: 2
2025-02-13 16:50:45,591 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 16:52:31,957 - INFO - Received aggregated weights with version: 3
2025-02-13 16:52:31,957 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 16:52:32,103 - INFO - Latest entry ID: 67ae699eaa7752fb4eaa1e94, Version: 3
2025-02-13 16:52:32,137 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 16:55:07,646 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 16:55:25,446 - INFO - Received aggregated weights with version: 4
2025-02-13 16:55:25,446 - WARNING - Client version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 16:55:25,545 - INFO - Latest entry ID: 67ae6a4caa7752fb4eaa1e96, Version: 4
2025-02-13 16:55:25,570 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 16:57:26,892 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 16:57:44,805 - INFO - Received aggregated weights with version: 5
2025-02-13 16:57:44,805 - WARNING - Client version 5 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 16:57:44,937 - INFO - Latest entry ID: 67ae6ad7aa7752fb4eaa1e98, Version: 5
2025-02-13 16:57:44,978 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 17:09:29,504 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:09:47,808 - INFO - Received aggregated weights with version: 1
2025-02-13 17:09:47,808 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:13:23,550 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:13:41,931 - INFO - Received aggregated weights with version: 2
2025-02-13 17:13:41,932 - WARNING - Client version 2 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 17:13:42,050 - INFO - Latest entry ID: 67ae6e94aa7752fb4eaa1e9c, Version: 2
2025-02-13 17:13:42,102 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 17:13:42,105 - ERROR - Exception calling application: name 'weights' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 144, in SendAggregatedWeights
    self.aggregated_weights.append(weights)
NameError: name 'weights' is not defined
2025-02-13 17:14:31,365 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:14:49,703 - INFO - Received aggregated weights with version: 3
2025-02-13 17:14:49,703 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 17:14:49,793 - INFO - Latest entry ID: 67ae6ed8aa7752fb4eaa1e9e, Version: 3
2025-02-13 17:14:49,836 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 17:14:49,860 - INFO - Using latest weights from MongoDB for FedAvg.
2025-02-13 17:14:49,860 - ERROR - Exception calling application: string indices must be integers
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 151, in SendAggregatedWeights
    updated_model = fed_avg(self.global_model, latest_weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 11, in fed_avg
    value += torch.tensor(w[key_suffix]) / len(weights_updates)
TypeError: string indices must be integers
2025-02-13 17:15:55,504 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:16:13,923 - INFO - Received aggregated weights with version: 1
2025-02-13 17:16:13,923 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:16:13,942 - ERROR - Exception calling application: name 'use_latest_weights' is not defined
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 149, in SendAggregatedWeights
    if use_latest_weights:
NameError: name 'use_latest_weights' is not defined
2025-02-13 17:18:30,364 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:18:49,083 - INFO - Received aggregated weights with version: 1
2025-02-13 17:18:49,083 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:18:49,102 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:18:49,667 - ERROR - Exception calling application: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 154, in SendAggregatedWeights
    updated_model = fed_avg(self.global_model, weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 10, in fed_avg
    if key_suffix in w:
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/torch/_tensor.py", line 985, in __contains__
    raise RuntimeError(
RuntimeError: Tensor.__contains__ only supports Tensor or scalar, but you passed in a <class 'str'>.
2025-02-13 17:20:37,790 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:21:18,128 - INFO - Received aggregated weights with version: 1
2025-02-13 17:21:18,129 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:21:18,129 - ERROR - Exception calling application: 'google._upb._message.RepeatedScalarContainer' object has no attribute 'items'
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 142, in SendAggregatedWeights
    weights = {k: torch.tensor(v, dtype=torch.float32) for k, v in request.weights.items()}
AttributeError: 'google._upb._message.RepeatedScalarContainer' object has no attribute 'items'
2025-02-13 17:24:10,470 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:24:28,412 - INFO - Received aggregated weights with version: 1
2025-02-13 17:24:28,413 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:24:28,424 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:24:28,424 - ERROR - Exception calling application: string indices must be integers
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_server.py", line 610, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/server.py", line 158, in SendAggregatedWeights
    updated_model = fed_avg(self.global_model, weights)
  File "/home/cloudlabgpu1/grpc_spotlight/GRPC_top/Algorithms/fedavg.py", line 11, in fed_avg
    value += torch.tensor(w[key_suffix]) / len(weights_updates)
TypeError: string indices must be integers
2025-02-13 17:29:06,145 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:29:24,472 - INFO - Received aggregated weights with version: 1
2025-02-13 17:29:24,472 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:29:24,484 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:29:24,485 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-13 17:29:24,485 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.0008540153503417969 seconds.
2025-02-13 17:29:24,485 - INFO - Updated global model with version 2.
2025-02-13 17:29:25,572 - INFO - Task result: 67ae724500289dc7aa4a51be
2025-02-13 17:29:25,573 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-13 17:29:25,966 - INFO - Model weights sent successfully to L2 server.
2025-02-13 17:29:54,605 - INFO - Received aggregated weights with version: 3
2025-02-13 17:29:54,605 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 17:29:54,696 - INFO - Latest entry ID: 67ae7261aa7752fb4eaa1eaa, Version: 3
2025-02-13 17:29:54,724 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 17:29:54,740 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:29:54,751 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-02-13 17:29:54,751 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.011293172836303711 seconds.
2025-02-13 17:29:54,777 - INFO - Updated global model with version 4.
2025-02-13 17:29:55,798 - INFO - Task result: 67ae726300289dc7aa4a51c0
2025-02-13 17:29:56,144 - INFO - Model weights sent successfully to L2 server.
2025-02-13 17:37:22,929 - INFO - Top layer aggregator server started on port 8082.
2025-02-13 17:37:57,720 - INFO - Received aggregated weights with version: 1
2025-02-13 17:37:57,720 - INFO - Client version 1 is in sync with server version 1. Proceeding with aggregation.
2025-02-13 17:37:57,731 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:37:57,732 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-13 17:37:57,732 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.0008637905120849609 seconds.
2025-02-13 17:37:57,733 - INFO - Updated global model with version 2.
2025-02-13 17:37:58,753 - INFO - Task result: 67ae744600289dc7aa4a51c2
2025-02-13 17:37:58,753 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-13 17:37:59,127 - INFO - Model weights sent successfully to L2 server.
2025-02-13 17:38:22,574 - INFO - Received aggregated weights with version: 3
2025-02-13 17:38:22,574 - WARNING - Client version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-13 17:38:22,658 - INFO - Latest entry ID: 67ae745daa7752fb4eaa1eae, Version: 3
2025-02-13 17:38:22,689 - INFO - Loaded latest model weights from MongoDB.
2025-02-13 17:38:22,705 - INFO - Using received weights from l2 server for FedAvg.
2025-02-13 17:38:22,713 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-02-13 17:38:22,714 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.008051395416259766 seconds.
2025-02-13 17:38:22,739 - INFO - Updated global model with version 4.
2025-02-13 17:38:23,749 - INFO - Task result: 67ae745f00289dc7aa4a51c4
2025-02-13 17:38:24,108 - INFO - Model weights sent successfully to L2 server.
2025-02-14 18:19:33,140 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-14 18:19:33,156 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-14 18:19:33,156 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-14 18:19:33,156 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-14 18:19:33,156 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-14 18:19:33,157 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-14 18:19:33,158 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-14 18:29:48,833 - INFO - Top layer aggregator server started on port 8082.
2025-02-14 18:38:42,797 - INFO - Received aggregated weights with version: 5
2025-02-14 18:38:42,807 - WARNING - Received version 5 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-14 18:38:42,940 - INFO - Latest entry ID: 67afd401d5fb92547bafface, Version: 5
2025-02-14 18:38:42,972 - INFO - Loaded latest model weights from MongoDB.
2025-02-14 18:38:42,990 - INFO - Using received weights from l2 server for FedAvg.
2025-02-14 18:38:42,999 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-14 18:38:42,999 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.00923299789428711 seconds.
2025-02-14 18:38:43,021 - INFO - Updated global model with version 2.
2025-02-14 18:38:44,075 - INFO - Task result: 67afd4032cee9f806b00797c
2025-02-14 18:38:44,076 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-14 18:38:44,076 - ERROR - Failed to send model weights to L2 server: name 'send_model_to_edge_async' is not defined
2025-02-14 18:39:45,021 - INFO - Top layer aggregator server started on port 8082.
2025-02-14 18:40:03,268 - INFO - Received aggregated weights with version: 6
2025-02-14 18:40:03,268 - WARNING - Received version 6 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-14 18:40:03,352 - INFO - Latest entry ID: 67afd452d5fb92547baffad0, Version: 6
2025-02-14 18:40:03,389 - INFO - Loaded latest model weights from MongoDB.
2025-02-14 18:40:03,407 - INFO - Using received weights from l2 server for FedAvg.
2025-02-14 18:40:03,413 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-14 18:40:03,413 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.005812406539916992 seconds.
2025-02-14 18:40:03,438 - INFO - Updated global model with version 2.
2025-02-14 18:40:04,476 - INFO - Task result: 67afd4542cee9f806b00797e
2025-02-14 18:40:04,477 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-14 18:40:04,477 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-14 19:35:29,959 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-14 19:35:29,960 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-14 19:35:29,961 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-14 19:35:29,961 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-14 19:35:29,961 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-14 19:35:29,961 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-14 19:35:29,961 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-14 19:36:31,074 - INFO - Top layer aggregator server started on port 8082.
2025-02-14 19:42:32,880 - INFO - Received aggregated weights with version: 4
2025-02-14 19:42:32,880 - WARNING - Received version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-14 19:42:33,009 - INFO - Latest entry ID: 67afe2f77f42c8f30e03d779, Version: 4
2025-02-14 19:42:33,051 - INFO - Loaded latest model weights from MongoDB.
2025-02-14 19:42:33,069 - INFO - Using received weights from l2 server for FedAvg.
2025-02-14 19:42:33,082 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-14 19:42:33,082 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013587713241577148 seconds.
2025-02-14 19:42:33,101 - INFO - Updated global model with version 2.
2025-02-14 19:42:34,118 - INFO - Task result: 67afe2f90d82ac6cf342e4b6
2025-02-14 19:42:34,119 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-14 19:42:34,119 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-14 19:54:13,176 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-14 19:54:13,176 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-14 19:54:13,177 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-14 19:54:13,178 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-14 19:54:13,178 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-14 19:54:13,178 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-14 19:54:13,178 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-14 19:54:22,682 - INFO - Top layer aggregator server started on port 8082.
2025-02-14 19:54:47,155 - INFO - Received aggregated weights with version: 3
2025-02-14 19:54:47,155 - WARNING - Received version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-14 19:54:47,282 - INFO - Latest entry ID: 67afe5d67f6739c301a11098, Version: 3
2025-02-14 19:54:47,324 - INFO - Loaded latest model weights from MongoDB.
2025-02-14 19:54:47,341 - INFO - Using received weights from l2 server for FedAvg.
2025-02-14 19:54:47,357 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-14 19:54:47,357 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.016390085220336914 seconds.
2025-02-14 19:54:47,382 - INFO - Updated global model with version 2.
2025-02-14 19:54:48,474 - INFO - Task result: 67afe5d8c101de5b326a8dd3
2025-02-14 19:54:48,476 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-14 19:54:48,477 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 14:38:38,905 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 14:38:38,905 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 14:38:38,905 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 14:38:38,905 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 14:38:38,906 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 14:38:38,907 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 14:38:38,907 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 14:48:33,297 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 14:51:12,309 - INFO - Received aggregated weights with version: 3
2025-02-15 14:51:12,327 - WARNING - Received version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 14:51:12,457 - INFO - Latest entry ID: 67b0f02f5ef1ba4bc1071a7f, Version: 3
2025-02-15 14:51:12,500 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 14:51:12,516 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 14:51:12,517 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-15 14:51:12,517 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.0007283687591552734 seconds.
2025-02-15 14:51:12,518 - INFO - Updated global model with version 2.
2025-02-15 14:51:13,533 - INFO - Task result: 67b0f0310211309c12883a3e
2025-02-15 14:51:13,535 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 14:51:13,535 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 14:59:30,609 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 14:59:30,610 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 14:59:30,611 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 14:59:30,612 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 14:59:30,613 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 14:59:30,614 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 14:59:30,615 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 14:59:30,615 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 14:59:30,616 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 14:59:30,617 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 14:59:30,617 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 14:59:30,618 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 14:59:53,268 - INFO - Received aggregated weights with version: 4
2025-02-15 14:59:53,268 - WARNING - Received version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 14:59:53,409 - INFO - Latest entry ID: 67b0f2385ef1ba4bc1071a81, Version: 4
2025-02-15 14:59:53,443 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 14:59:53,463 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 14:59:53,489 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-02-15 14:59:53,489 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.025748252868652344 seconds.
2025-02-15 14:59:53,503 - INFO - Updated global model with version 4.
2025-02-15 14:59:54,580 - INFO - Task result: 67b0f23a427d2c9edb44d458
2025-02-15 14:59:54,582 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 15:02:45,194 - INFO - Received aggregated weights with version: 5
2025-02-15 15:02:45,194 - WARNING - Received version 5 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 15:02:45,307 - INFO - Latest entry ID: 67b0f2e35ef1ba4bc1071a83, Version: 5
2025-02-15 15:02:45,337 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 15:02:45,353 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 15:02:45,366 - INFO - Applied FedAvg and updated the global model. Current version: 5
2025-02-15 15:02:45,367 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013493776321411133 seconds.
2025-02-15 15:02:45,396 - INFO - Updated global model with version 6.
2025-02-15 15:02:46,595 - INFO - Task result: 67b0f2e6427d2c9edb44d45a
2025-02-15 15:02:46,596 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 15:39:01,807 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 15:39:49,554 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 15:39:49,554 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 15:39:49,554 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 15:39:49,555 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 15:39:49,556 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 15:39:49,556 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 15:39:49,556 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 16:06:51,264 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 16:06:51,265 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 16:06:51,265 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 16:06:51,265 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 16:06:51,265 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 16:06:51,265 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 16:06:51,266 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 16:07:05,797 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 16:10:09,360 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 16:10:09,361 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 16:10:09,362 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 16:10:09,362 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 16:10:09,362 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 16:10:09,362 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 16:10:09,362 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 16:10:20,182 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 17:02:01,192 - INFO - Received aggregated weights with version: 23
2025-02-15 17:02:01,192 - WARNING - Received version 23 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 17:02:01,280 - INFO - Latest entry ID: 67b10ed80da8bd48f731c336, Version: 23
2025-02-15 17:02:01,325 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 17:02:01,343 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 17:02:01,357 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-15 17:02:01,357 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013631105422973633 seconds.
2025-02-15 17:02:01,376 - INFO - Updated global model with version 2.
2025-02-15 17:02:02,446 - INFO - Task result: 67b10eda15d8812b5ab8ac78
2025-02-15 17:02:02,448 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 17:02:02,449 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 17:04:25,544 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 17:07:16,710 - INFO - Received aggregated weights with version: 31
2025-02-15 17:07:16,710 - WARNING - Received version 31 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 17:07:16,835 - INFO - Latest entry ID: 67b110130da8bd48f731c33e, Version: 31
2025-02-15 17:07:16,878 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 17:07:16,897 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 17:07:16,911 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-15 17:07:16,911 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013787984848022461 seconds.
2025-02-15 17:07:16,937 - INFO - Updated global model with version 2.
2025-02-15 17:07:17,967 - INFO - Task result: 67b1101515d8812b5ab8ac7a
2025-02-15 17:07:17,969 - INFO - Found spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 17:07:17,969 - INFO - Spot instance is available. Sending updated model to L2 server.
2025-02-15 17:07:17,969 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 17:09:10,758 - INFO - Received aggregated weights with version: 33
2025-02-15 17:09:10,758 - WARNING - Received version 33 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 17:09:10,902 - INFO - Latest entry ID: 67b110850da8bd48f731c340, Version: 33
2025-02-15 17:09:10,937 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 17:09:10,953 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 17:09:10,966 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-02-15 17:09:10,967 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.01357412338256836 seconds.
2025-02-15 17:09:10,971 - INFO - Updated global model with version 4.
2025-02-15 17:09:11,954 - INFO - Task result: 67b1108715d8812b5ab8ac7c
2025-02-15 17:09:11,956 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 17:09:11,956 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 17:09:11,956 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 17:39:47,641 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 17:39:47,642 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 17:39:47,642 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 17:39:47,642 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 17:39:47,642 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 17:39:47,642 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 17:39:47,643 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 17:40:05,988 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 17:43:17,172 - INFO - Received aggregated weights with version: 7
2025-02-15 17:43:17,172 - WARNING - Received version 7 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 17:43:17,260 - INFO - Latest entry ID: 67b11884be43f5434b0c7698, Version: 7
2025-02-15 17:43:17,308 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 17:43:17,326 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 17:43:17,340 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-15 17:43:17,340 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013551473617553711 seconds.
2025-02-15 17:43:17,361 - INFO - Updated global model with version 2.
2025-02-15 17:43:18,396 - INFO - Task result: 67b11886cf6c6ece8e6ceb51
2025-02-15 17:43:18,398 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 17:43:18,398 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 17:43:18,399 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 17:57:25,125 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 17:57:25,125 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 17:57:25,126 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 17:57:25,127 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 17:57:25,127 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 17:57:25,127 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 17:57:25,127 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 17:57:40,466 - INFO - Top layer aggregator server started on port 8082.
2025-02-15 17:58:03,172 - INFO - Received aggregated weights with version: 3
2025-02-15 17:58:03,172 - WARNING - Received version 3 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 17:58:03,270 - INFO - Latest entry ID: 67b11bfaf8fc0a1b40109ced, Version: 3
2025-02-15 17:58:03,295 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 17:58:03,312 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 17:58:03,328 - INFO - Applied FedAvg and updated the global model. Current version: 1
2025-02-15 17:58:03,328 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.016313552856445312 seconds.
2025-02-15 17:58:03,349 - INFO - Updated global model with version 2.
2025-02-15 17:58:04,395 - INFO - Task result: 67b11bfcd652b9e351eb97e3
2025-02-15 17:58:04,397 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 17:58:04,397 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 17:58:04,397 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 18:01:18,075 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-15 18:01:18,075 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-15 18:01:18,076 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-15 18:01:18,077 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-15 18:01:18,077 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-15 18:01:18,077 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-15 18:01:18,077 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-15 18:01:38,389 - INFO - Received aggregated weights with version: 4
2025-02-15 18:01:38,389 - WARNING - Received version 4 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 18:01:38,462 - INFO - Latest entry ID: 67b11cd1f8fc0a1b40109cef, Version: 4
2025-02-15 18:01:38,486 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 18:01:38,502 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 18:01:38,506 - INFO - Applied FedAvg and updated the global model. Current version: 3
2025-02-15 18:01:38,506 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.004167795181274414 seconds.
2025-02-15 18:01:38,507 - INFO - Updated global model with version 4.
2025-02-15 18:01:39,536 - INFO - Task result: 67b11cd3763036781cdc1ce7
2025-02-15 18:01:39,537 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 18:01:39,537 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 18:03:52,048 - INFO - Received aggregated weights with version: 5
2025-02-15 18:03:52,048 - WARNING - Received version 5 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 18:03:52,118 - INFO - Latest entry ID: 67b11d57f8fc0a1b40109cf1, Version: 5
2025-02-15 18:03:52,145 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 18:03:52,161 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 18:03:52,166 - INFO - Applied FedAvg and updated the global model. Current version: 5
2025-02-15 18:03:52,167 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.005675792694091797 seconds.
2025-02-15 18:03:52,184 - INFO - Updated global model with version 6.
2025-02-15 18:03:53,213 - INFO - Task result: 67b11d58763036781cdc1ce9
2025-02-15 18:03:53,216 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 18:03:53,216 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 18:06:49,352 - INFO - Received aggregated weights with version: 7
2025-02-15 18:06:49,352 - WARNING - Received version 7 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 18:06:49,422 - INFO - Latest entry ID: 67b11e08f8fc0a1b40109cf3, Version: 7
2025-02-15 18:06:49,445 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 18:06:49,461 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 18:06:49,487 - INFO - Applied FedAvg and updated the global model. Current version: 7
2025-02-15 18:06:49,488 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.02634882926940918 seconds.
2025-02-15 18:06:49,489 - INFO - Updated global model with version 8.
2025-02-15 18:06:50,474 - INFO - Task result: 67b11e0a763036781cdc1ceb
2025-02-15 18:06:50,475 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 18:06:50,475 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 18:10:33,488 - INFO - Received aggregated weights with version: 9
2025-02-15 18:10:33,488 - WARNING - Received version 9 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 18:10:33,559 - INFO - Latest entry ID: 67b11ee8f8fc0a1b40109cf5, Version: 9
2025-02-15 18:10:33,573 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 18:10:33,588 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 18:10:33,588 - INFO - Applied FedAvg and updated the global model. Current version: 9
2025-02-15 18:10:33,589 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.0005905628204345703 seconds.
2025-02-15 18:10:33,589 - INFO - Updated global model with version 10.
2025-02-15 18:10:34,629 - INFO - Task result: 67b11eea763036781cdc1ced
2025-02-15 18:10:34,630 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 18:10:34,630 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-15 18:13:24,414 - INFO - Received aggregated weights with version: 11
2025-02-15 18:13:24,414 - WARNING - Received version 11 is ahead of the server version 1. Fetching latest weights from MongoDB.
2025-02-15 18:13:24,484 - INFO - Latest entry ID: 67b11f93f8fc0a1b40109cf7, Version: 11
2025-02-15 18:13:24,509 - INFO - Loaded latest model weights from MongoDB.
2025-02-15 18:13:24,525 - INFO - Using received weights from l2 server for FedAvg.
2025-02-15 18:13:24,539 - INFO - Applied FedAvg and updated the global model. Current version: 11
2025-02-15 18:13:24,539 - INFO - FedAvg applied, updated the global model. Aggregation time: 0.013497352600097656 seconds.
2025-02-15 18:13:24,564 - INFO - Updated global model with version 12.
2025-02-15 18:13:25,586 - INFO - Task result: 67b11f95763036781cdc1cef
2025-02-15 18:13:25,588 - INFO - Found spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-12 10:54:14.691000
2025-02-15 18:13:25,589 - INFO - Spot instance is not available. Sending updated model to edge device.
2025-02-26 21:33:17,062 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-26 21:33:17,086 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-26 21:33:17,086 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-26 21:33:17,086 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-26 21:33:17,087 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-26 21:33:17,087 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-26 21:33:17,087 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-26 21:33:17,088 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-26 21:33:17,088 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-26 21:33:17,089 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-26 21:33:17,089 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-26 21:33:17,089 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-26 21:36:14,000 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-26 21:36:14,000 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-26 21:36:14,000 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-26 21:36:14,001 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-26 21:36:14,001 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-26 21:36:14,001 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-26 21:36:14,001 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-26 21:36:14,001 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-26 21:36:14,002 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-26 21:36:14,002 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-26 21:36:14,002 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-26 21:36:14,002 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-26 21:40:46,777 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-26 21:40:46,778 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-26 22:06:28,557 - INFO - Top layer aggregator server started on port 8082.
2025-02-26 22:07:08,383 - INFO - Top layer aggregator server started on port 8082.
2025-02-26 22:15:52,855 - INFO - Top layer aggregator server started on port 8082.
2025-02-26 23:52:20,640 - INFO - Top layer aggregator server started on port 8082.
2025-02-26 23:59:52,275 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:02:20,269 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:03:23,765 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:05:55,312 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:05:55,313 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:05:55,314 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:05:55,314 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:05:55,314 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:05:55,314 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:05:55,314 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:07:56,660 - ERROR - Exception deserializing message!
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_common.py", line 89, in _transform
    return transformer(message)
google.protobuf.message.DecodeError: Error parsing message with type 'grpc.top.AggregatedWeights'
2025-02-27 00:09:38,521 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:09:59,732 - ERROR - Exception deserializing message!
Traceback (most recent call last):
  File "/home/cloudlabgpu1/shenv/lib/python3.10/site-packages/grpc/_common.py", line 89, in _transform
    return transformer(message)
google.protobuf.message.DecodeError: Error parsing message with type 'grpc.top.AggregatedWeights'
2025-02-27 00:17:04,490 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:17:26,536 - INFO - Received aggregated weights with version: 18
2025-02-27 00:17:26,536 - ERROR - Unknown model name: 
2025-02-27 00:23:20,625 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:23:39,475 - INFO - Received aggregated weights with version: 20
2025-02-27 00:23:39,477 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:23:39,478 - WARNING - Client version 20 is ahead. Fetching latest weights.
2025-02-27 00:23:39,568 - INFO - Latest entry ID: 67bff6da22b09d05715daefe, Version: 20
2025-02-27 00:23:39,600 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:23:39,705 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:23:40,095 - INFO - Spot instance status: Layer=l2, Kill_signal=True, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:23:40,095 - WARNING - No spot instance status found.
2025-02-27 00:23:40,095 - INFO - Sending updated model to edge device.
2025-02-27 00:23:40,096 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:26:31,568 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:26:50,594 - INFO - Received aggregated weights with version: 21
2025-02-27 00:26:50,596 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:26:50,597 - WARNING - Client version 21 is ahead. Fetching latest weights.
2025-02-27 00:26:50,725 - INFO - Latest entry ID: 67bff79922b09d05715daf00, Version: 21
2025-02-27 00:26:50,770 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:26:50,873 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:26:51,198 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:26:51,198 - INFO - Sending updated model to L2 server.
2025-02-27 00:26:51,198 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:29:01,111 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:29:13,755 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:29:13,755 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:29:13,755 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:29:13,755 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:29:13,756 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:29:13,756 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:29:13,756 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:29:13,756 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:29:13,756 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:29:13,757 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:29:13,757 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:29:13,757 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:29:32,912 - INFO - Received aggregated weights with version: 22
2025-02-27 00:29:32,915 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:29:32,915 - WARNING - Client version 22 is ahead. Fetching latest weights.
2025-02-27 00:29:33,001 - INFO - Latest entry ID: 67bff83b7e5eee9a44b0a7b9, Version: 22
2025-02-27 00:29:33,047 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:29:33,151 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:29:33,522 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:29:33,522 - INFO - Sending updated model to L2 server.
2025-02-27 00:29:33,523 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:33:10,996 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:33:10,996 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:33:10,997 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:33:10,998 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:33:10,998 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:33:10,998 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:33:10,998 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:33:15,655 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:33:33,796 - INFO - Received aggregated weights with version: 23
2025-02-27 00:33:33,799 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:33:33,799 - WARNING - Client version 23 is ahead. Fetching latest weights.
2025-02-27 00:33:33,896 - INFO - Latest entry ID: 67bff92c395ac7a0e1d00120, Version: 23
2025-02-27 00:33:33,941 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:33:34,043 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:33:34,372 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:33:34,372 - INFO - Sending updated model to L2 server.
2025-02-27 00:33:34,372 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:35:20,482 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:35:31,036 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:35:31,036 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:35:31,036 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:35:31,036 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:35:31,036 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:35:31,036 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:35:31,037 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:35:49,860 - INFO - Received aggregated weights with version: 24
2025-02-27 00:35:49,863 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:35:49,863 - WARNING - Client version 24 is ahead. Fetching latest weights.
2025-02-27 00:35:49,952 - INFO - Latest entry ID: 67bff9b4f4f45d527b4057ed, Version: 24
2025-02-27 00:35:49,985 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:35:50,079 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:35:50,418 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:35:50,418 - INFO - Sending updated model to L2 server.
2025-02-27 00:35:50,418 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:38:39,719 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:38:50,943 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:38:50,943 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:38:50,943 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:38:50,943 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:38:50,943 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:38:50,943 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:38:50,944 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:38:50,944 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:38:50,944 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:38:50,944 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:38:50,944 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:38:50,945 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:39:09,610 - INFO - Received aggregated weights with version: 25
2025-02-27 00:39:09,613 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:39:09,613 - WARNING - Client version 25 is ahead. Fetching latest weights.
2025-02-27 00:39:09,742 - INFO - Latest entry ID: 67bffa7c7e847b19a76c999c, Version: 25
2025-02-27 00:39:09,784 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:39:09,896 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:39:10,233 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:39:10,233 - INFO - Sending updated model to L2 server.
2025-02-27 00:39:10,233 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:42:36,111 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-27 00:42:36,111 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-27 00:42:36,111 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-27 00:42:36,111 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:42:36,111 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-27 00:42:36,112 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-27 00:42:36,113 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-27 00:42:43,962 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 00:43:02,015 - INFO - Received aggregated weights with version: 26
2025-02-27 00:43:02,017 - INFO - Using SimpleCNN model for weight updates.
2025-02-27 00:43:02,017 - WARNING - Client version 26 is ahead. Fetching latest weights.
2025-02-27 00:43:02,108 - INFO - Latest entry ID: 67bffb64b8043c91eafd8078, Version: 26
2025-02-27 00:43:02,149 - INFO - Loaded latest model weights from MongoDB.
2025-02-27 00:43:02,245 - INFO - FedAvg applied, updated the model to version 1.
2025-02-27 00:43:02,613 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-02-27 00:43:02,613 - INFO - Sending updated model to L2 server.
2025-02-27 00:43:02,613 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-27 00:50:40,255 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 01:09:00,381 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 01:22:01,196 - INFO - Top layer aggregator server started on port 8082.
2025-02-27 01:36:21,003 - INFO - Top layer aggregator server started on port 8082.
2025-02-28 16:02:10,307 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def backend_cleanup():
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-02-28 16:02:10,329 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-02-28 16:02:10,330 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-02-28 16:02:10,330 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-02-28 16:02:10,330 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-02-28 16:02:10,330 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-02-28 16:02:10,330 - DEBUG - 
def xmap(task, it):
    return 1

2025-02-28 17:51:46,088 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 12:40:10,949 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 13:29:21,085 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 13:29:34,848 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 13:29:34,849 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 13:29:34,849 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 13:29:34,849 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 13:29:34,849 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 13:29:34,849 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 13:29:34,850 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 13:30:24,605 - INFO - Received aggregated weights with version: 2
2025-03-01 13:30:24,648 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:30:24,773 - INFO - Fetched latest model weights for simplecnn, Version: 2
2025-03-01 13:30:24,789 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:30:24,937 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 13:30:25,380 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:30:25,380 - INFO - Sending updated model to L2 server.
2025-03-01 13:30:25,380 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 13:35:39,583 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 13:36:02,249 - INFO - Received aggregated weights with version: 1
2025-03-01 13:36:02,251 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:36:02,340 - INFO - Fetched latest model weights for simplecnn, Version: 1
2025-03-01 13:36:02,359 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:36:02,493 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 13:36:02,893 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:36:02,893 - INFO - Sending updated model to L2 server.
2025-03-01 13:36:02,894 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 13:37:04,720 - INFO - Received aggregated weights with version: 3
2025-03-01 13:37:04,722 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:37:04,797 - INFO - Fetched latest model weights for simplecnn, Version: 3
2025-03-01 13:37:04,814 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:37:04,934 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 13:37:05,293 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:37:05,293 - INFO - Sending updated model to L2 server.
2025-03-01 13:48:51,276 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 13:50:07,817 - INFO - Received aggregated weights with version: 3
2025-03-01 13:50:07,820 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:50:07,921 - INFO - Fetched latest model weights for simplecnn, Version: 3
2025-03-01 13:50:07,945 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:50:08,023 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 13:50:08,427 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:50:08,427 - INFO - Sending updated model to L2 server.
2025-03-01 13:50:08,427 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 13:52:08,661 - INFO - Received aggregated weights with version: 2
2025-03-01 13:52:08,664 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:52:08,735 - INFO - Fetched latest model weights for simplecnn, Version: 2
2025-03-01 13:52:08,750 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:52:08,850 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 13:52:09,210 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:52:09,211 - INFO - Sending updated model to L2 server.
2025-03-01 13:54:08,177 - INFO - Received aggregated weights with version: 3
2025-03-01 13:54:08,180 - INFO - Using simplecnn model for weight updates.
2025-03-01 13:54:08,255 - INFO - Fetched latest model weights for simplecnn, Version: 3
2025-03-01 13:54:08,273 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:54:08,365 - INFO - FedAvg applied, updated the model to version 3.
2025-03-01 13:54:08,724 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:54:08,724 - INFO - Sending updated model to L2 server.
2025-03-01 13:59:26,205 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 13:59:43,955 - INFO - Received aggregated weights with version: 4
2025-03-01 13:59:44,114 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 13:59:44,194 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 13:59:44,598 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 13:59:44,598 - INFO - Sending updated model to L2 server.
2025-03-01 13:59:44,598 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:06:04,020 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:06:21,681 - INFO - Received aggregated weights with version: 2
2025-03-01 14:06:21,818 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:06:21,897 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:06:22,299 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:06:22,300 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:06:22,300 - INFO - Sending updated model to L2 server.
2025-03-01 14:06:22,300 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:09:37,202 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:10:27,371 - INFO - Received aggregated weights with version: 2
2025-03-01 14:10:27,504 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:10:27,604 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:10:28,013 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:10:28,013 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:10:28,013 - INFO - Sending updated model to L2 server.
2025-03-01 14:10:28,013 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:15:03,642 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 14:15:03,642 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 14:15:03,642 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 14:15:03,642 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 14:15:03,643 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:15:03,644 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 14:15:03,644 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 14:15:13,745 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:16:14,565 - INFO - Received aggregated weights with version: 2
2025-03-01 14:16:14,719 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:16:14,813 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:16:15,213 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:16:15,213 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:16:15,213 - INFO - Sending updated model to L2 server.
2025-03-01 14:16:15,213 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:24:37,468 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:29:24,458 - INFO - Received aggregated weights with version: 1
2025-03-01 14:29:24,615 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:29:24,699 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:29:25,099 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:29:25,100 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:29:25,100 - INFO - Sending updated model to L2 server.
2025-03-01 14:29:25,100 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:33:16,814 - INFO - Received aggregated weights with version: 2
2025-03-01 14:33:16,917 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:33:17,018 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 14:33:17,366 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:33:17,366 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:33:17,366 - INFO - Sending updated model to L2 server.
2025-03-01 14:34:15,307 - INFO - Received aggregated weights with version: 1
2025-03-01 14:34:15,401 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:34:15,485 - INFO - FedAvg applied, updated the model to version 3.
2025-03-01 14:34:15,830 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:34:15,830 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:34:15,830 - INFO - Sending updated model to L2 server.
2025-03-01 14:38:57,845 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 14:38:57,845 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:38:57,845 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 14:38:57,845 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 14:38:57,845 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 14:38:57,846 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 14:38:57,847 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 14:39:38,953 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:45:12,194 - INFO - Received aggregated weights with version: 2
2025-03-01 14:45:12,364 - INFO - Fetched latest model weights for simplecnn, Version: 2
2025-03-01 14:45:12,384 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:45:12,464 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:45:12,867 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:45:12,867 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:45:12,867 - INFO - Sending updated model to L2 server.
2025-03-01 14:45:12,867 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:45:24,709 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 14:45:42,120 - INFO - Received aggregated weights with version: 1
2025-03-01 14:45:42,236 - INFO - Fetched latest model weights for simplecnn, Version: 1
2025-03-01 14:45:42,297 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 14:45:42,393 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 14:45:42,805 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 14:45:42,806 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 14:45:42,806 - INFO - Sending updated model to L2 server.
2025-03-01 14:45:42,806 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 14:46:52,654 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:18:15,148 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 20:18:15,154 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 20:18:15,155 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 20:18:15,156 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 20:18:15,156 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 20:18:15,156 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 20:18:15,156 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 20:35:55,437 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:41:14,426 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:47:02,096 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:47:45,415 - INFO - Received aggregated weights with version: 1
2025-03-01 20:47:45,591 - INFO - Fetched latest model weights for simplecnn, Version: 1
2025-03-01 20:47:45,617 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 20:47:45,621 - INFO - Updated current version to 2
2025-03-01 20:47:45,697 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 20:47:46,127 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 20:47:46,128 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 20:47:46,128 - INFO - Sending updated model to L2 server.
2025-03-01 20:47:46,128 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 20:48:25,522 - INFO - Received aggregated weights with version: 1
2025-03-01 20:48:25,620 - INFO - Fetched latest model weights for simplecnn, Version: 1
2025-03-01 20:48:25,638 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 20:48:25,641 - INFO - Updated current version to 2
2025-03-01 20:48:25,728 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 20:48:26,100 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 20:48:26,100 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 20:48:26,100 - INFO - Sending updated model to L2 server.
2025-03-01 20:49:37,247 - INFO - Received aggregated weights with version: 4
2025-03-01 20:49:37,327 - INFO - Fetched latest model weights for simplecnn, Version: 4
2025-03-01 20:49:37,361 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 20:49:37,365 - INFO - Updated current version to 5
2025-03-01 20:49:37,441 - INFO - FedAvg applied, updated the model to version 3.
2025-03-01 20:49:37,807 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 20:49:37,807 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 20:49:37,807 - INFO - Sending updated model to L2 server.
2025-03-01 20:50:44,796 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:51:04,004 - INFO - Received aggregated weights with version: 2
2025-03-01 20:51:04,120 - INFO - Fetched latest model weights for simplecnn, Version: 2
2025-03-01 20:51:04,142 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 20:51:04,146 - INFO - Updated current version to 3
2025-03-01 20:51:04,230 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 20:51:04,656 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 20:51:04,656 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 20:51:04,656 - INFO - Sending updated model to L2 server.
2025-03-01 20:51:04,656 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 20:53:59,715 - INFO - Received aggregated weights with version: 3
2025-03-01 20:53:59,792 - INFO - Fetched latest model weights for simplecnn, Version: 3
2025-03-01 20:53:59,810 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 20:53:59,814 - INFO - Updated current version to 4
2025-03-01 20:53:59,903 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 20:54:00,261 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 20:54:00,261 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 20:54:00,261 - INFO - Sending updated model to L2 server.
2025-03-01 20:58:52,025 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 20:59:59,873 - INFO - Received aggregated weights with version: 4
2025-03-01 21:00:00,004 - INFO - Fetched latest model weights for simplecnn, Version: 4
2025-03-01 21:00:00,024 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 21:00:00,028 - INFO - Updated current version to 5
2025-03-01 21:00:00,110 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 21:00:00,512 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 21:00:00,512 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 21:00:00,512 - INFO - Sending updated model to L2 server.
2025-03-01 21:00:00,513 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:00:00,614 - ERROR - Connection to Redis lost: Retry (0/20) now.
2025-03-01 21:00:00,614 - ERROR - Connection to Redis lost: Retry (1/20) in 1.00 second.
2025-03-01 21:00:01,616 - ERROR - Connection to Redis lost: Retry (2/20) in 1.00 second.
2025-03-01 21:00:02,618 - ERROR - Connection to Redis lost: Retry (3/20) in 1.00 second.
2025-03-01 21:00:03,620 - ERROR - Connection to Redis lost: Retry (4/20) in 1.00 second.
2025-03-01 21:00:04,622 - ERROR - Connection to Redis lost: Retry (5/20) in 1.00 second.
2025-03-01 21:00:05,624 - ERROR - Connection to Redis lost: Retry (6/20) in 1.00 second.
2025-03-01 21:00:06,626 - ERROR - Connection to Redis lost: Retry (7/20) in 1.00 second.
2025-03-01 21:00:07,628 - ERROR - Connection to Redis lost: Retry (8/20) in 1.00 second.
2025-03-01 21:00:08,630 - ERROR - Connection to Redis lost: Retry (9/20) in 1.00 second.
2025-03-01 21:00:09,632 - ERROR - Connection to Redis lost: Retry (10/20) in 1.00 second.
2025-03-01 21:00:10,634 - ERROR - Connection to Redis lost: Retry (11/20) in 1.00 second.
2025-03-01 21:00:11,636 - ERROR - Connection to Redis lost: Retry (12/20) in 1.00 second.
2025-03-01 21:00:12,639 - ERROR - Connection to Redis lost: Retry (13/20) in 1.00 second.
2025-03-01 21:00:13,641 - ERROR - Connection to Redis lost: Retry (14/20) in 1.00 second.
2025-03-01 21:00:14,642 - ERROR - Connection to Redis lost: Retry (15/20) in 1.00 second.
2025-03-01 21:00:15,644 - ERROR - Connection to Redis lost: Retry (16/20) in 1.00 second.
2025-03-01 21:00:16,646 - ERROR - Connection to Redis lost: Retry (17/20) in 1.00 second.
2025-03-01 21:00:17,648 - ERROR - Connection to Redis lost: Retry (18/20) in 1.00 second.
2025-03-01 21:00:18,651 - ERROR - Connection to Redis lost: Retry (19/20) in 1.00 second.
2025-03-01 21:00:19,653 - CRITICAL - 
Retry limit exceeded while trying to reconnect to the Celery redis result store backend. The Celery application must be restarted.

2025-03-01 21:00:19,653 - ERROR - Failed to send model weights: Error 111 connecting to 127.0.0.1:6389. Connection refused.
2025-03-01 21:00:26,912 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 21:00:26,912 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 21:00:26,913 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 21:00:26,913 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:00:26,913 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 21:00:26,914 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 21:00:26,914 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 21:00:26,914 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 21:00:26,915 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 21:00:26,915 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 21:00:26,916 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 21:00:26,916 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 21:06:13,406 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 21:06:13,406 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 21:06:13,407 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 21:06:13,408 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 21:06:13,408 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 21:06:13,408 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 21:06:13,408 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 21:09:41,843 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 21:09:41,843 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 21:09:41,843 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 21:09:41,843 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 21:09:41,843 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 21:09:41,844 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 21:09:41,844 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 21:09:41,844 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 21:09:41,844 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 21:09:41,844 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 21:09:41,845 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 21:09:41,845 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:10:07,532 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 21:10:34,883 - INFO - Received aggregated weights with version: 3
2025-03-01 21:10:35,024 - INFO - Fetched latest model weights for simplecnn, Version: 3
2025-03-01 21:10:35,047 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 21:10:35,051 - INFO - Updated current version to 4
2025-03-01 21:10:35,128 - INFO - FedAvg applied, updated the model to version 1.
2025-03-01 21:10:35,524 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 21:10:35,524 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 21:10:35,524 - INFO - Sending updated model to L2 server.
2025-03-01 21:10:35,525 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:18:34,953 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 21:19:01,269 - INFO - Received aggregated weights with version: 2
2025-03-01 21:19:01,399 - INFO - Fetched latest model weights for simplecnn, Version: 2
2025-03-01 21:19:01,439 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 21:19:01,445 - INFO - Updated current version to 3
2025-03-01 21:19:01,573 - INFO - FedAvg applied, updated the model to version 4.
2025-03-01 21:19:02,007 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 21:19:02,007 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 21:19:02,007 - INFO - Sending updated model to L2 server.
2025-03-01 21:19:02,007 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:25:12,332 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 21:25:40,289 - INFO - Received aggregated weights with version: 1
2025-03-01 21:25:40,412 - INFO - Fetched latest model weights for simplecnn, Version: 1
2025-03-01 21:25:40,437 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-01 21:25:40,441 - INFO - Updated current version to 2
2025-03-01 21:25:40,528 - INFO - FedAvg applied, updated the model to version 2.
2025-03-01 21:25:40,931 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 21:25:40,932 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-01 21:25:40,932 - INFO - Sending updated model to L2 server.
2025-03-01 21:25:40,932 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 21:28:10,101 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 23:20:53,231 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 23:26:42,806 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-01 23:26:42,806 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-01 23:26:42,806 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-01 23:26:42,806 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 23:26:42,806 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-01 23:26:42,806 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-01 23:26:42,807 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-01 23:26:42,807 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-01 23:26:42,807 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-01 23:26:42,807 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-01 23:26:42,807 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-01 23:26:42,808 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-01 23:35:46,036 - INFO - Received aggregated weights with version: 4
2025-03-01 23:35:46,148 - INFO - Fetched latest model weights for twocnn, Version: 4
2025-03-01 23:35:46,171 - INFO - Loaded latest model weights for twocnn from MongoDB.
2025-03-01 23:35:46,292 - INFO - FedAvg applied, updated the model to version 5.
2025-03-01 23:35:46,699 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-01 23:35:46,699 - INFO - Sending model 'twocnn' with 421642 weights to L2
2025-03-01 23:35:46,699 - INFO - Sending updated model to L2 server.
2025-03-01 23:35:46,699 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-01 23:50:40,230 - INFO - Top layer aggregator server started on port 8082.
2025-03-01 23:57:46,536 - INFO - Received aggregated weights with version: 1
2025-03-01 23:57:46,536 - ERROR - Unknown model name: logistic_regression
2025-03-01 23:59:04,389 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 00:03:01,129 - INFO - Received aggregated weights with version: 2
2025-03-02 00:03:01,165 - INFO - Fetched latest model weights for logistic_regression, Version: 2
2025-03-02 00:03:01,167 - INFO - Loaded latest model weights for logistic_regression from MongoDB.
2025-03-02 00:03:01,170 - INFO - FedAvg applied, updated the model to version 3.
2025-03-02 00:03:01,252 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 00:03:01,252 - INFO - Sending model 'logistic_regression' with 30730 weights to L2
2025-03-02 00:03:01,252 - INFO - Sending updated model to L2 server.
2025-03-02 00:03:01,253 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 00:09:34,213 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 00:16:34,283 - INFO - Received aggregated weights with version: 4
2025-03-02 00:16:34,551 - INFO - Fetched latest model weights for squeezenet, Version: 4
2025-03-02 00:16:34,577 - INFO - Loaded latest model weights for squeezenet from MongoDB.
2025-03-02 00:16:35,700 - INFO - FedAvg applied, updated the model to version 5.
2025-03-02 00:16:36,361 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 00:16:36,361 - INFO - Sending model 'squeezenet' with 727626 weights to L2
2025-03-02 00:16:36,361 - INFO - Sending updated model to L2 server.
2025-03-02 00:16:36,361 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 00:22:48,390 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 00:55:50,374 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 01:21:49,044 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-02 01:21:49,044 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-02 01:21:49,045 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-02 01:21:49,046 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-02 01:21:49,046 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-02 01:21:49,046 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-02 01:21:49,046 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-02 01:22:20,714 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 01:35:29,751 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 01:59:43,099 - INFO - Received aggregated weights with version: 1
2025-03-02 01:59:45,214 - WARNING - No valid weights found in MongoDB for densenet. Using default model: DenseNetModel.
2025-03-02 02:02:17,209 - INFO - FedAvg applied, updated the model to version 2.
2025-03-02 02:02:23,263 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 02:02:23,263 - INFO - Sending model 'densenet' with 6964106 weights to L2
2025-03-02 02:02:23,263 - INFO - Sending updated model to L2 server.
2025-03-02 02:02:23,263 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 02:23:29,721 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 02:23:43,468 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-02 02:23:43,468 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-02 02:23:43,468 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-02 02:23:43,468 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 02:23:43,469 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-02 02:23:43,469 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-02 02:23:43,469 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-02 02:23:43,469 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-02 02:23:43,469 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-02 02:23:43,470 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-02 02:23:43,470 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-02 02:23:43,470 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-02 02:35:59,879 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-02 02:35:59,879 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-02 02:35:59,879 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-02 02:35:59,879 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-02 02:35:59,880 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-02 02:35:59,881 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-02 02:35:59,881 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-02 02:55:19,697 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 02:57:20,976 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 03:05:01,385 - INFO - Received aggregated weights with version: 9
2025-03-02 03:05:01,500 - INFO - Fetched latest model weights for simplecnn, Version: 8
2025-03-02 03:05:01,558 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 03:05:01,701 - INFO - FedAvg applied, updated the model to version 10.
2025-03-02 03:05:01,885 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 03:05:01,885 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 03:05:01,886 - INFO - Sending updated model to L2 server.
2025-03-02 03:05:01,886 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:40:53,802 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 13:45:49,099 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-02 13:45:49,099 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-02 13:45:49,099 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-02 13:45:49,099 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:45:49,099 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-02 13:45:49,100 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-02 13:45:49,100 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-02 13:45:49,100 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-02 13:45:49,100 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-02 13:45:49,100 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-02 13:45:49,101 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-02 13:45:49,101 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-02 13:45:50,861 - INFO - Received aggregated weights with version: 1
2025-03-02 13:45:51,307 - WARNING - No valid weights found in MongoDB for densenet. Using selected model weights.
2025-03-02 13:46:29,293 - INFO - Received aggregated weights with version: 10
2025-03-02 13:46:34,111 - INFO - Fetched latest model weights for simplecnn, Version: 10
2025-03-02 13:46:36,380 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 13:46:40,079 - INFO - FedAvg applied, updated the model to version 11.
2025-03-02 13:46:40,299 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:46:40,299 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 13:46:40,299 - INFO - Sending updated model to L2 server.
2025-03-02 13:46:40,299 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:46:40,429 - INFO - FedAvg applied, updated the model to version 11.
2025-03-02 13:46:46,716 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:46:46,716 - INFO - Sending model 'densenet' with 6964106 weights to L2
2025-03-02 13:46:46,716 - INFO - Sending updated model to L2 server.
2025-03-02 13:50:12,114 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 13:50:29,045 - INFO - Received aggregated weights with version: 12
2025-03-02 13:50:29,155 - INFO - Fetched latest model weights for simplecnn, Version: 11
2025-03-02 13:50:29,201 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 13:50:29,337 - INFO - FedAvg applied, updated the model to version 13.
2025-03-02 13:50:29,531 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:50:29,532 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 13:50:29,532 - INFO - Sending updated model to L2 server.
2025-03-02 13:50:29,532 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:51:32,811 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 13:51:47,037 - INFO - Received aggregated weights with version: 14
2025-03-02 13:51:47,163 - INFO - Fetched latest model weights for simplecnn, Version: 13
2025-03-02 13:51:47,219 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 13:51:47,339 - INFO - FedAvg applied, updated the model to version 15.
2025-03-02 13:51:47,514 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:51:47,514 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 13:51:47,514 - INFO - Sending updated model to L2 server.
2025-03-02 13:51:47,514 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:52:18,225 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 13:52:44,524 - INFO - Received aggregated weights with version: 16
2025-03-02 13:52:44,667 - INFO - Fetched latest model weights for simplecnn, Version: 15
2025-03-02 13:52:44,703 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 13:52:44,809 - INFO - FedAvg applied, updated the model to version 17.
2025-03-02 13:52:45,014 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:52:45,014 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 13:52:45,014 - INFO - Sending updated model to L2 server.
2025-03-02 13:52:45,014 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-02 13:53:17,106 - INFO - Top layer aggregator server started on port 8082.
2025-03-02 13:53:31,954 - INFO - Received aggregated weights with version: 18
2025-03-02 13:53:32,080 - INFO - Fetched latest model weights for simplecnn, Version: 17
2025-03-02 13:53:32,117 - INFO - Loaded latest model weights for simplecnn from MongoDB.
2025-03-02 13:53:32,256 - INFO - FedAvg applied, updated the model to version 19.
2025-03-02 13:53:32,434 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-02 13:53:32,434 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-02 13:53:32,434 - INFO - Sending updated model to L2 server.
2025-03-02 13:53:32,434 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-09 19:12:03,378 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-09 19:12:03,401 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-09 19:12:03,402 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-09 19:12:03,402 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-09 19:12:03,402 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-09 19:12:03,402 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-09 19:12:03,402 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-09 19:12:03,403 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-09 19:12:03,403 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-09 19:12:03,403 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-09 19:12:03,403 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-09 19:12:03,403 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-09 19:30:37,976 - INFO - Top layer aggregator server started on port 8082.
2025-03-10 00:35:13,602 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-10 00:35:13,625 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-10 00:35:13,625 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-10 00:35:13,625 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-10 00:35:13,626 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-10 00:35:13,627 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-10 00:35:13,627 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-10 00:40:39,414 - INFO - Top layer aggregator server started on port 8082.
2025-03-10 19:26:44,225 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-10 19:26:44,254 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-10 19:26:44,254 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-10 19:26:44,255 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-10 19:26:44,256 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-10 19:26:44,256 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-10 19:26:44,256 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-10 19:36:13,845 - INFO - Top layer aggregator server started on port 8082.
2025-03-11 20:44:21,409 - INFO - Top layer aggregator server started on port 8082.
2025-03-11 20:44:52,353 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-11 20:44:52,353 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-11 20:44:52,353 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-11 20:44:52,353 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-11 20:44:52,354 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-11 20:44:52,355 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-11 20:44:52,355 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-11 20:46:06,553 - INFO - Received aggregated weights with version: 6
2025-03-11 20:46:06,696 - ERROR - Error fetching weights for simplecnn from MongoDB: Expected state_dict to be dict-like, got <class 'list'>.
2025-03-11 20:46:06,784 - INFO - FedAvg applied, updated the model to version 7.
2025-03-11 20:46:07,184 - INFO - Spot instance status: Layer=l2, Kill_signal=False, Timestamp=2025-02-26 22:39:10.675000
2025-03-11 20:46:07,184 - INFO - Sending model 'simplecnn' with 420352 weights to L2
2025-03-11 20:46:07,185 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-11 20:46:40,745 - INFO - Top layer aggregator server started on port 8082.
2025-03-11 21:01:56,708 - INFO - Received aggregated weights with version: 320
2025-03-11 21:01:56,896 - INFO - Decompressing weights for resnet.
2025-03-11 21:01:56,897 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-11 21:05:37,499 - INFO - FedAvg applied, updated the model to version 321.
2025-03-11 21:05:37,955 - INFO - Compressing weights for resnet before storing.
2025-03-11 21:05:37,955 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-11 22:28:00,204 - INFO - Received aggregated weights with version: 320
2025-03-11 22:28:00,334 - INFO - Decompressing weights for resnet.
2025-03-11 22:28:00,334 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-11 22:28:01,340 - WARNING - Received version 320 is behind stored version 321. Using latest version 321.
2025-03-11 22:31:41,105 - INFO - FedAvg applied, updated the model to version 322.
2025-03-11 22:31:41,559 - INFO - Compressing weights for resnet before storing.
2025-03-11 22:31:41,559 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-11 22:39:17,982 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-11 22:39:17,982 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-11 22:39:17,982 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-11 22:39:17,983 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-11 22:39:17,983 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-11 22:39:17,983 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-11 22:39:17,984 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-11 22:39:17,984 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-11 22:39:17,984 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-11 22:39:17,984 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-11 22:39:17,984 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-11 22:39:17,985 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-11 22:39:48,077 - INFO - Received aggregated weights with version: 320
2025-03-11 22:39:48,079 - WARNING - No valid weights found in MongoDB for resnet. Using default weights.
2025-03-11 22:39:49,386 - WARNING - Received version 320 is behind stored version 322. Using latest version 322.
2025-03-11 22:43:30,676 - INFO - FedAvg applied, updated the model to version 323.
2025-03-11 22:43:31,130 - INFO - Compressing weights for resnet before storing.
2025-03-11 22:43:31,130 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-11 23:00:54,186 - INFO - Received aggregated weights with version: 320
2025-03-11 23:00:54,541 - ERROR - Error fetching weights for resnet from MongoDB: Expected state_dict to be dict-like, got <class 'bytes'>.
2025-03-11 23:00:54,787 - WARNING - Received version 320 is behind stored version 323. Using latest version 323.
2025-03-11 23:05:01,805 - INFO - FedAvg applied, updated the model to version 324.
2025-03-11 23:05:03,856 - INFO - Compressing weights for resnet before storing.
2025-03-11 23:05:03,856 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-11 23:05:18,385 - INFO - Received aggregated weights with version: 320
2025-03-11 23:05:19,449 - ERROR - Error fetching weights for resnet from MongoDB: Expected state_dict to be dict-like, got <class 'bytes'>.
2025-03-11 23:05:19,696 - WARNING - Received version 320 is behind stored version 324. Using latest version 324.
2025-03-11 23:09:20,102 - INFO - FedAvg applied, updated the model to version 325.
2025-03-11 23:09:20,658 - INFO - Compressing weights for resnet before storing.
2025-03-11 23:09:20,658 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-11 23:56:01,152 - INFO - Received aggregated weights with version: 320
2025-03-11 23:56:01,154 - WARNING - No valid weights found in MongoDB for resnet. Using default weights.
2025-03-11 23:56:02,231 - WARNING - Received version 320 is behind stored version 325. Using latest version 325.
2025-03-11 23:59:43,872 - INFO - FedAvg applied, updated the model to version 326.
2025-03-11 23:59:44,393 - INFO - Compressing weights for resnet before storing.
2025-03-11 23:59:44,393 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 01:16:15,837 - INFO - Received aggregated weights with version: 320
2025-03-12 01:16:15,962 - INFO - Decompressing weights for resnet.
2025-03-12 01:16:15,962 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-12 01:16:16,822 - WARNING - Received version 320 is behind stored version 326. Using latest version 326.
2025-03-12 01:16:17,587 - INFO - FedAvg applied, updated the model to version 327.
2025-03-12 01:16:18,077 - INFO - Compressing weights for resnet before storing.
2025-03-12 01:16:18,078 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 01:24:29,775 - INFO - Received aggregated weights with version: 320
2025-03-12 01:24:29,776 - WARNING - No valid weights found in MongoDB for resnet. Using default weights.
2025-03-12 01:24:31,074 - WARNING - Received version 320 is behind stored version 327. Using latest version 327.
2025-03-12 01:24:31,629 - INFO - FedAvg applied, updated the model to version 328.
2025-03-12 01:24:32,116 - INFO - Compressing weights for resnet before storing.
2025-03-12 01:24:32,116 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 01:43:14,727 - INFO - Received aggregated weights with version: 320
2025-03-12 01:43:14,850 - INFO - Decompressing weights for resnet.
2025-03-12 01:43:14,850 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-12 01:43:15,080 - WARNING - Received version 320 is behind stored version 328. Using latest version 328.
2025-03-12 01:43:15,105 - INFO - FedAvg applied, updated the model to version 329.
2025-03-12 01:43:15,565 - INFO - Compressing weights for resnet before storing.
2025-03-12 01:43:15,565 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 01:57:24,306 - INFO - Received aggregated weights with version: 320
2025-03-12 01:57:24,428 - INFO - Decompressing weights for resnet.
2025-03-12 01:57:24,428 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-12 01:57:24,660 - WARNING - Received version 320 is behind stored version 329. Using latest version 329.
2025-03-12 01:57:24,686 - INFO - FedAvg applied, updated the model to version 330.
2025-03-12 01:57:25,147 - INFO - Compressing weights for resnet before storing.
2025-03-12 01:57:25,147 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 01:59:31,835 - INFO - Received aggregated weights with version: 320
2025-03-12 01:59:31,958 - INFO - Decompressing weights for resnet.
2025-03-12 01:59:31,958 - ERROR - Error decompressing weights for resnet: Invalid data stream
2025-03-12 01:59:32,189 - WARNING - Received version 320 is behind stored version 330. Using latest version 330.
2025-03-12 01:59:32,214 - INFO - FedAvg applied, updated the model to version 331.
2025-03-12 01:59:32,674 - INFO - Compressing weights for resnet before storing.
2025-03-12 01:59:32,674 - ERROR - Error compressing weights for resnet: name 'io' is not defined
2025-03-12 02:02:12,827 - INFO - Top layer aggregator server started on port 8082.
2025-03-12 02:07:50,941 - INFO - 🔄 Top layer aggregator server started on port 8082.
2025-03-12 02:09:45,146 - INFO - 📡 Received aggregated weights for resnet, version 320
2025-03-12 02:09:46,264 - INFO - 🔄 Reconstructing model weights from 6 chunks for resnet (Batch ID: resnet_20250312060941).
2025-03-12 02:09:46,264 - INFO - ✅ Chunk sizes: [15728640, 15728640, 15728640, 15728640, 15728640, 11198559] | Total size before joining: 89841759 bytes
2025-03-12 02:09:46,313 - INFO - ✅ Successfully joined 6 chunks. Total size: 89841759 bytes
2025-03-12 02:09:47,440 - DEBUG - 
def xstarmap(task, it):
    return 1

2025-03-12 02:09:47,440 - DEBUG - 
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

2025-03-12 02:09:47,440 - DEBUG - 
def accumulate(self, *args, **kwargs):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def chunks(task, it, n):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def send_model_to_edge_async(weights_payload):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def xmap(task, it):
    return 1

2025-03-12 02:09:47,441 - DEBUG - 
def send_model_to_l2_async(weights_payload):
    return 1

2025-03-12 02:09:47,442 - DEBUG - 
def chain(*args, **kwargs):
    return 1

2025-03-12 02:09:47,442 - DEBUG - 
def backend_cleanup():
    return 1

2025-03-12 02:09:47,442 - DEBUG - 
def store_aggregated_weights_task(model_weights, model_name):
    return 1

2025-03-12 02:09:50,439 - INFO - ✅ Successfully decompressed 94383163 bytes.
2025-03-12 02:09:50,439 - INFO - 🔍 First 20 bytes after decompression: b'\x80\x02\x8a\nl\xfc\x9cF\xf9 j\xa8P\x19.\x80\x02M\xe9\x03'
2025-03-12 02:09:50,466 - INFO - ✅ Successfully loaded PyTorch state_dict for resnet. Type: <class 'collections.OrderedDict'>
2025-03-12 02:09:50,760 - INFO - ✅ Loaded latest model weights for resnet from MongoDB.
2025-03-12 02:09:50,770 - INFO - 🔄 Decompressing received model weights for resnet
2025-03-12 02:09:50,770 - ERROR - ❌ Error decompressing received weights: Ran out of input
2025-03-12 02:12:57,693 - INFO - 🔄 Top layer aggregator server started on port 8082.
2025-03-12 02:14:51,472 - INFO - 📡 Received aggregated weights for resnet, version 320
2025-03-12 02:14:52,636 - INFO - 🔄 Reconstructing model weights from 6 chunks for resnet (Batch ID: resnet_20250312061447).
2025-03-12 02:14:52,637 - INFO - ✅ Chunk sizes: [15728640, 15728640, 15728640, 15728640, 15728640, 11203790] | Total size before joining: 89846990 bytes
2025-03-12 02:14:52,685 - INFO - ✅ Successfully joined 6 chunks. Total size: 89846990 bytes
2025-03-12 02:14:56,629 - INFO - ✅ Successfully decompressed 94383163 bytes.
2025-03-12 02:14:56,630 - INFO - 🔍 First 20 bytes after decompression: b'\x80\x02\x8a\nl\xfc\x9cF\xf9 j\xa8P\x19.\x80\x02M\xe9\x03'
2025-03-12 02:14:56,657 - INFO - ✅ Successfully loaded PyTorch state_dict for resnet. Type: <class 'collections.OrderedDict'>
2025-03-12 02:14:56,951 - INFO - ✅ Loaded latest model weights for resnet from MongoDB.
2025-03-12 02:14:56,961 - WARNING - ⚠ Unexpected version jump: received 320, stored 4. Correcting.
2025-03-12 02:14:56,962 - INFO - 🔄 Checking if received model weights for resnet are compressed.
2025-03-12 02:14:56,962 - ERROR - ❌ Error decompressing received weights: 'google._upb._message.RepeatedScalarContainer' object has no attribute 'startswith'
2025-03-12 02:17:02,522 - INFO - 🔄 Top layer aggregator server started on port 8082.
2025-03-12 02:18:56,309 - INFO - 📡 Received aggregated weights for resnet, version 320
2025-03-12 02:18:57,442 - INFO - 🔄 Reconstructing model weights from 6 chunks for resnet (Batch ID: resnet_20250312061852).
2025-03-12 02:18:57,443 - INFO - ✅ Chunk sizes: [15728640, 15728640, 15728640, 15728640, 15728640, 11198255] | Total size before joining: 89841455 bytes
2025-03-12 02:18:57,492 - INFO - ✅ Successfully joined 6 chunks. Total size: 89841455 bytes
2025-03-12 02:19:01,492 - INFO - ✅ Successfully decompressed 94383163 bytes.
2025-03-12 02:19:01,492 - INFO - 🔍 First 20 bytes after decompression: b'\x80\x02\x8a\nl\xfc\x9cF\xf9 j\xa8P\x19.\x80\x02M\xe9\x03'
2025-03-12 02:19:01,519 - INFO - ✅ Successfully loaded PyTorch state_dict for resnet. Type: <class 'collections.OrderedDict'>
2025-03-12 02:19:01,812 - INFO - ✅ Loaded latest model weights for resnet from MongoDB.
2025-03-12 02:19:01,822 - WARNING - ⚠ Unexpected version jump: received 320, stored 5. Correcting.
2025-03-12 02:19:01,822 - INFO - 🔄 Checking if received model weights for resnet are compressed.
2025-03-12 02:19:01,822 - WARNING - ⚠ Received model weights are NOT compressed. Loading directly.
2025-03-12 02:19:01,822 - ERROR - ❌ Error processing received weights: a bytes-like object is required, not 'google._upb._message.RepeatedScalarContainer'
2025-03-12 02:24:09,042 - INFO - 🔄 Top layer aggregator server started on port 8082.
2025-03-12 02:26:08,455 - INFO - 📡 Received aggregated weights for resnet, version 320
2025-03-12 02:26:09,587 - INFO - 🔄 Reconstructing model weights from 6 chunks for resnet (Batch ID: resnet_20250312062604).
2025-03-12 02:26:09,588 - INFO - ✅ Chunk sizes: [15728640, 15728640, 15728640, 15728640, 15728640, 11201024] | Total size before joining: 89844224 bytes
2025-03-12 02:26:09,637 - INFO - ✅ Successfully joined 6 chunks. Total size: 89844224 bytes
2025-03-12 02:26:13,618 - INFO - ✅ Successfully decompressed 94383163 bytes.
2025-03-12 02:26:13,618 - INFO - 🔍 First 20 bytes after decompression: b'\x80\x02\x8a\nl\xfc\x9cF\xf9 j\xa8P\x19.\x80\x02M\xe9\x03'
2025-03-12 02:26:13,644 - INFO - ✅ Successfully loaded PyTorch state_dict for resnet. Type: <class 'collections.OrderedDict'>
2025-03-12 02:26:13,947 - INFO - ✅ Loaded latest model weights for resnet from MongoDB.
2025-03-12 02:26:13,957 - WARNING - ⚠ Unexpected version jump: received 320, stored 6. Correcting.
2025-03-12 02:26:13,957 - INFO - 🔄 Checking if received model weights for resnet are compressed.
2025-03-12 02:26:13,957 - WARNING - ⚠ Received model weights are NOT compressed. Attempting direct load.
2025-03-12 02:26:13,957 - ERROR - ❌ Error processing received weights: a bytes-like object is required, not 'google._upb._message.RepeatedScalarContainer'
